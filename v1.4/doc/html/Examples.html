<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>SyncPy library Examples &mdash; Home Page</title>
    
    <link rel="stylesheet" href="_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon_isir.ico"/>
    <link rel="top" title="Home Page" href="index.html" />
    <link rel="next" title="Publications" href="References.html" />
    <link rel="prev" title="Utils package" href="utils.html" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body>
<div class="header">
  <div class="logo">
    <a href="HomePage.html">
      <img class="logo" src="_static/hearder_image.png" alt="Logo"/>
    </a>
  </div>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="References.html" title="Publications"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="utils.html" title="Utils package"
             accesskey="P">previous</a> |</li>
        <li><a href="HomePage.html">Home Page</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="syncpy-library-examples">
<span id="examples-reference"></span><h1>SyncPy library Examples<a class="headerlink" href="#syncpy-library-examples" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="available-source-code-examples">
<p class="topic-title first">Available source code examples</p>
<ul class="simple">
<li><a class="reference internal" href="#datafrom2persons-univariate-categorical-linear-module" id="id1">DataFrom2Persons Univariate Categorical Linear module</a><ul>
<li><a class="reference internal" href="#boolean-turn-activity-example" id="id2">Boolean Turn Activity example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#datafrom2persons-univariate-categorical-nonlinear-module" id="id3">DataFrom2Persons Univariate Categorical Nonlinear module</a><ul>
<li><a class="reference internal" href="#event-synchronization-example" id="id4">Event Synchronization example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#datafrom2persons-univariate-continuous-linear-module" id="id5">DataFrom2Persons Univariate Continuous Linear module</a><ul>
<li><a class="reference internal" href="#coherence-example" id="id6">Coherence example</a></li>
<li><a class="reference internal" href="#correlation-example" id="id7">Correlation example</a></li>
<li><a class="reference internal" href="#granger-causality-example" id="id8">Granger Causality example</a></li>
<li><a class="reference internal" href="#spectral-granger-causality-example" id="id9">Spectral Granger Causality example</a></li>
<li><a class="reference internal" href="#window-cross-correlation-example" id="id10">Window Cross Correlation example</a></li>
<li><a class="reference internal" href="#window-cross-correlation-with-peakpicking-example" id="id11">Window Cross Correlation with PeakPicking example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#datafrom2persons-univariate-continuous-nonlinear-module" id="id12">DataFrom2Persons Univariate Continuous NonLinear module</a><ul>
<li><a class="reference internal" href="#nonlinear-correlation-example" id="id13">Nonlinear Correlation example</a></li>
<li><a class="reference internal" href="#mutual-information-example" id="id14">Mutual Information example</a></li>
<li><a class="reference internal" href="#window-mutual-information-example" id="id15">Window Mutual Information example</a></li>
<li><a class="reference internal" href="#phasesynchro-strobo-example" id="id16">PhaseSynchro_Strobo example</a></li>
<li><a class="reference internal" href="#phasesynchro-entropy-example" id="id17">PhaseSynchro_Entropy example</a></li>
<li><a class="reference internal" href="#phasesynchro-fourier-example" id="id18">PhaseSynchro_Fourier example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#datafrommanypersons-univariate-continuous-linear-module" id="id19">DataFromManyPersons Univariate Continuous Linear module</a><ul>
<li><a class="reference internal" href="#conditional-granger-causality-example" id="id20">Conditional Granger Causality example</a></li>
<li><a class="reference internal" href="#omega-complexity-example" id="id21">Omega complexity example</a></li>
<li><a class="reference internal" href="#partialcoherence-example" id="id22">PartialCoherence example</a></li>
<li><a class="reference internal" href="#s-estimator-example" id="id23">S_Estimator example</a></li>
<li><a class="reference internal" href="#multiple-granger-causality-example" id="id24">Multiple Granger Causality example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#datafrom2persons-multivariate-continuous-nonlinear-module" id="id25">DataFrom2Persons Multivariate Continuous NonLinear module</a><ul>
<li><a class="reference internal" href="#gsi-example" id="id26">GSI example</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="datafrom2persons-univariate-categorical-linear-module">
<h2><a class="toc-backref" href="#id1">DataFrom2Persons Univariate Categorical Linear module</a><a class="headerlink" href="#datafrom2persons-univariate-categorical-linear-module" title="Permalink to this headline">¶</a></h2>
<div class="section" id="boolean-turn-activity-example">
<h3><a class="toc-backref" href="#id2">Boolean Turn Activity example</a><a class="headerlink" href="#boolean-turn-activity-example" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference download internal" href="_downloads/BooleanTurnsActivity.py"><tt class="xref download docutils literal"><span class="pre">Source</span> <span class="pre">code</span></tt></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">BooleanTurnsActivity example :</span>
<span class="sd">Computes data turns statistics between two boolean univariate signals x and y (in DataFrame format):</span>
<span class="sd">x signal activity duration, y signal activity duration, pause duration, overlap duration,</span>
<span class="sd">x signal pause duration, y signal pause duration, pause duration between x and y activity,</span>
<span class="sd">synchrony ratios between x and y (defined by max_latency)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Import common python packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>          <span class="c"># Mathematical package</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>         <span class="c"># Time serie package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span> <span class="c"># Plotting package</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;../src/&#39;</span><span class="p">)</span>   <span class="c"># To be able to import packages from parent directory </span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************************************************************&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;This script computes the boolean turn activty of two categorical univariate signals </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************************************************************&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Import wanted module with every parent packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">DataFrom2Persons.Univariate.Categorical.Linear.BooleanTurnsActivity</span> <span class="kn">as</span> <span class="nn">BooleanTurnsActivity</span>

<span class="sd">&quot;&quot;&quot; Import Utils modules &quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">utils.ExtractSignal</span> <span class="kn">import</span> <span class="n">ExtractSignalFromELAN</span>

<span class="sd">&quot;&quot;&quot; Define signals in pd.dataFrame format &quot;&quot;&quot;</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd"># Create signals</span>
<span class="sd">user0_data = pd.DataFrame({&#39;X&#39;:[0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0]})</span>
<span class="sd">user1_data = pd.DataFrame({&#39;Y&#39;:[0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1]})</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="c"># Import signals from .csv file, example with an ELAN data file</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s">&#39;data_examples/ELAN_2Persons.csv&#39;</span>
<span class="n">user0_data</span> <span class="o">=</span> <span class="n">ExtractSignalFromELAN</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span> <span class="n">total_duration</span> <span class="o">=</span> <span class="mi">240</span><span class="p">,</span>
                                    <span class="n">ele_per_sec</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">Actor</span> <span class="o">=</span> <span class="s">&#39;Maman&#39;</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="s">&#39;all&#39;</span><span class="p">)</span>
<span class="n">user1_data</span> <span class="o">=</span> <span class="n">ExtractSignalFromELAN</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span> <span class="n">total_duration</span> <span class="o">=</span> <span class="mi">240</span><span class="p">,</span>
                                    <span class="n">ele_per_sec</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">Actor</span> <span class="o">=</span> <span class="s">&#39;Bebe&#39;</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="s">&#39;all&#39;</span><span class="p">)</span>

<span class="c"># plot input signals</span>
<span class="n">ele_per_sec</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">ele_per_sec</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">user0_data</span><span class="o">.</span><span class="n">size</span><span class="p">)]</span> <span class="c"># create x axis values</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Time (ms)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Input signals&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,[</span><span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">user0_data</span><span class="o">.</span><span class="n">values</span><span class="p">],</span><span class="s">&#39;g.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">user0_data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">user1_data</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s">&#39;b.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">user1_data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_transform</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">transFigure</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Define class attributes of the wanted method &quot;&quot;&quot;</span>
<span class="n">max_latency</span> <span class="o">=</span> <span class="mf">3.0</span>           <span class="c"># the maximal delay between the two signals activity to define synchrony (in second)</span>
<span class="n">min_pause_duration</span> <span class="o">=</span> <span class="mf">0.01</span>   <span class="c"># minimal time for defining a pause (in second)</span>
<span class="n">ele_per_sec</span> <span class="o">=</span> <span class="mi">5</span>             <span class="c"># number of element in one second. Default: 1</span>
<span class="n">duration</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>               <span class="c"># total activity duration (in second). Default or -1 : len(x)*ele_per_sec</span>

<span class="sd">&quot;&quot;&quot; Instantiate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">turns</span> <span class="o">=</span> <span class="n">BooleanTurnsActivity</span><span class="o">.</span><span class="n">BooleanTurnsActivity</span><span class="p">(</span><span class="n">max_latency</span><span class="p">,</span> <span class="n">min_pause_duration</span><span class="p">,</span> <span class="n">ele_per_sec</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in BooleanTurnsActivity constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in BooleanTurnsActivity constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in BooleanTurnsActivity constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance of the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;maximal latency = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">max_latency</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;minimal pause duration = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">min_pause_duration</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;number of element per second = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ele_per_sec</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;duration = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">duration</span><span class="p">))</span>

<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">try</span> <span class="p">:</span> 
    <span class="n">res_turns</span><span class="p">,</span> <span class="n">turns_ratio</span> <span class="o">=</span> <span class="n">turns</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">user0_data</span><span class="p">,</span> <span class="n">user1_data</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in BooleanTurnsActivity computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in BooleanTurnsActivity computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in BooleanTurnsActivity computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Display result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;**************************************** </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Boolean turns activity complete result :&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res_turns</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">turns_ratio</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Get simple statistics of the result &quot;&quot;&quot;</span>
<span class="n">stats</span> <span class="o">=</span> <span class="n">res_turns</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>

<span class="sd">&quot;&quot;&quot; Display statistics result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;***********************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Boolean turns activity statistics :&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;***********************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span>

<span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Push ENTER key to exit.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="datafrom2persons-univariate-categorical-nonlinear-module">
<h2><a class="toc-backref" href="#id3">DataFrom2Persons Univariate Categorical Nonlinear module</a><a class="headerlink" href="#datafrom2persons-univariate-categorical-nonlinear-module" title="Permalink to this headline">¶</a></h2>
<div class="section" id="event-synchronization-example">
<h3><a class="toc-backref" href="#id4">Event Synchronization example</a><a class="headerlink" href="#event-synchronization-example" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference download internal" href="_downloads/EventSync.py"><tt class="xref download docutils literal"><span class="pre">Source</span> <span class="pre">code</span></tt></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Event Synchronisation example:</span>
<span class="sd">It computes Event Synchornisation (ES) and time delay patterns between two monovariate signals x and y</span>
<span class="sd">(in pandas DataFrame format) in which events can be identified using Quian Quiroga&#39;s method.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Import common python packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>      <span class="c"># Mathematical package</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>     <span class="c"># Time serie package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span> <span class="c"># Plotting package</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;../src/&#39;</span><span class="p">)</span>   <span class="c"># To be able to import packages from parent directory </span>

<span class="k">print</span> <span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;******************************************************************************************&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;This scripts compute the synchronisation and time delay pattern between two monovariate</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">+</span>
      <span class="s">&quot;signals (in pandas DataFrame format) showing events.&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;******************************************************************************************&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Import wanted module with every parent packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">DataFrom2Persons.Univariate.Categorical.Nonlinear.EventSync</span> <span class="kn">as</span> <span class="nn">EventSync</span>

<span class="sd">&quot;&quot;&quot; Import Utils modules &quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">utils.ExtractSignal</span> <span class="kn">import</span> <span class="n">ExtractSignalFromCSV</span>


<span class="sd">&quot;&quot;&quot; Define input signals in pd.dataFrame format &quot;&quot;&quot;</span>

<span class="c">#input signals</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Generating the input signals...&quot;</span><span class="p">)</span>

<span class="n">N</span><span class="o">=</span><span class="mi">26</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>


<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">&quot;&quot;&quot;OR&quot;&quot;&quot;</span>
<span class="sd">&quot;&quot;&quot; Import signals from a .csv file &quot;&quot;&quot;</span>
<span class="sd">#Data from files</span>
<span class="sd">filename = &#39;data_examples/2Persons_Univariate_Categorical_data.csv&#39;</span>


<span class="sd">x = ExtractSignalFromCSV(filename, columns = [&#39;0&#39;])</span>
<span class="sd">y = ExtractSignalFromCSV(filename, columns = [&#39;1&#39;])</span>


<span class="sd">&#39;&#39;&#39;</span>
<span class="n">s</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">f</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Input signals&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">)</span>


<span class="sd">&quot;&quot;&quot; Define class attributes of the wanted method &quot;&quot;&quot;</span>
<span class="n">atype</span> <span class="o">=</span> <span class="s">&#39;tot&#39;</span>                      <span class="c"># algorithm to be used to compute Q and q</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">1</span>                            <span class="c"># algorithm is used to estimates the delay</span>
<span class="n">lag_tau</span> <span class="o">=</span> <span class="mi">2</span>                        <span class="c"># number of samples will be used as delay</span>
<span class="n">window</span> <span class="o">=</span> <span class="mi">1</span>                         <span class="c"># size of the window to compute Q and q</span>
<span class="n">plot</span><span class="o">=</span> <span class="bp">False</span>                        <span class="c"># plot of Q and q</span>

<span class="sd">&quot;&quot;&quot; Instanciate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">c</span><span class="o">=</span><span class="n">EventSync</span><span class="o">.</span><span class="n">EventSync</span><span class="p">(</span><span class="n">atype</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">lag_tau</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">plot</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in EventSync constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in EventSync constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in EventSync constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;type = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">atype</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;tau = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;lag_tau = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">lag_tau</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;window= &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">window</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;plot = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">plot</span><span class="p">))</span>


<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">res</span><span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in EventSync computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in EventSync computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in EventSync computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Display result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;**************************************** </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;EventSync complete result :&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;Q:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s">&#39;Q&#39;</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;q:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s">&#39;q&#39;</span><span class="p">])</span>

<span class="sd">&quot;&quot;&quot; OTHER EXAMPLE WITH TSL TYPE &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;*************************************************** </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;*************************************************** </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Define class attributes of the wanted method &quot;&quot;&quot;</span>
<span class="n">atype</span> <span class="o">=</span> <span class="s">&#39;tsl&#39;</span>                      <span class="c"># algorithm to be used to compute Q and q</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">1</span>                            <span class="c"># algorithm is used to estimates the delay</span>
<span class="n">lag_tau</span> <span class="o">=</span> <span class="mi">2</span>                        <span class="c"># number of samples will be used as delay</span>
<span class="n">window</span> <span class="o">=</span> <span class="mi">30</span>                         <span class="c"># size of the window to compute Q and q</span>
<span class="n">plot</span><span class="o">=</span> <span class="bp">True</span>                         <span class="c"># plot of Q and q</span>

<span class="sd">&quot;&quot;&quot; Instanciate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">c</span><span class="o">=</span><span class="n">EventSync</span><span class="o">.</span><span class="n">EventSync</span><span class="p">(</span><span class="n">atype</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">lag_tau</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">plot</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in EventSync constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in EventSync constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in EventSync constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>


<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;type = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">atype</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;tau = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;lag_tau = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">lag_tau</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;window= &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">window</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;plot = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">plot</span><span class="p">))</span>

<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">res</span><span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in EventSync computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in EventSync computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in EventSync computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Display result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;**************************************** </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;EventSync complete result :&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;Q:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s">&#39;Q&#39;</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;q:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s">&#39;q&#39;</span><span class="p">])</span>

<span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Push ENTER key to exit.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="datafrom2persons-univariate-continuous-linear-module">
<h2><a class="toc-backref" href="#id5">DataFrom2Persons Univariate Continuous Linear module</a><a class="headerlink" href="#datafrom2persons-univariate-continuous-linear-module" title="Permalink to this headline">¶</a></h2>
<div class="section" id="coherence-example">
<h3><a class="toc-backref" href="#id6">Coherence example</a><a class="headerlink" href="#coherence-example" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference download internal" href="_downloads/Coherence.py"><tt class="xref download docutils literal"><span class="pre">Source</span> <span class="pre">code</span></tt></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Coherence example :</span>
<span class="sd">It computes coherence function between two continuous univariate signals x and y (in pandas DataFrame format).</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Import common python packages &quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Import common python packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>          <span class="c"># Mathematical package</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>         <span class="c"># Time serie package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span> <span class="c"># Plotting package</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;../src/&#39;</span><span class="p">)</span>   <span class="c"># To be able to import packages from parent directory </span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************************************************************&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;This script computes the coherence of two continuous univariate signals. </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;First input is a sum among a sinewave of 100 Hz frequency,  a cosinewave </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;of 200 Hz frequency and unformly distributed random noise. The second one</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;is a sub-multiple of the first one.&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************************************************************&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Import wanted module with every parent packages &quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">DataFrom2Persons.Univariate.Continuous.Linear.Coherence</span> <span class="kn">as</span> <span class="nn">Coherence</span>


<span class="sd">&quot;&quot;&quot; Import Utils modules &quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">Standardize</span>
<span class="kn">from</span> <span class="nn">utils.ExtractSignal</span> <span class="kn">import</span> <span class="n">ExtractSignalFromCSV</span>


<span class="sd">&quot;&quot;&quot; Define signals in pd.dataFrame format &quot;&quot;&quot;</span>
<span class="n">Fs</span><span class="o">=</span><span class="mf">1000.0</span> <span class="c"># sampling frequency (Hz)</span>

<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">Fs</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="n">Fs</span><span class="p">)</span> <span class="c">#number or samples</span>

<span class="c"># Create signals</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">100</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">200</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">)})</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;Y&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">100</span><span class="o">*</span><span class="n">t</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="mf">0.35</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">200</span><span class="o">*</span><span class="n">t</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">)})</span>


<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">&quot;&quot;&quot;OR&quot;&quot;&quot;</span>
<span class="sd">&quot;&quot;&quot; Import signals from a .csv file &quot;&quot;&quot;</span>
<span class="sd">#Data from files</span>
<span class="sd">filename = &#39;data_examples/2Persons_Univariate_Continuous_data.csv&#39;</span>

<span class="sd">x = ExtractSignalFromCSV(filename, columns = [&#39;x1&#39;])</span>
<span class="sd">y = ExtractSignalFromCSV(filename, columns = [&#39;x2&#39;])</span>
<span class="sd">t=np.arange(0,x.shape[0])</span>
<span class="sd">&#39;&#39;&#39;</span>


<span class="sd">&quot;&quot;&quot; Plot input signals &quot;&quot;&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">f</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Input signals&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Define class attributes of the wanted method &quot;&quot;&quot;</span>
<span class="n">Fs</span><span class="o">=</span><span class="mf">1000.0</span>       <span class="c"># sampling frequency (Hz)</span>
<span class="n">NFFT</span> <span class="o">=</span> <span class="mi">100</span>      <span class="c"># length of each epoch</span>
<span class="n">detrend</span> <span class="o">=</span> <span class="mi">1</span>     <span class="c"># remove constant detrending</span>
<span class="n">noverlap</span> <span class="o">=</span> <span class="mi">80</span>   <span class="c"># number of points of overlap between epochs</span>
<span class="n">plot</span> <span class="o">=</span> <span class="bp">True</span>     <span class="c"># plot of the coherence function</span>

<span class="sd">&quot;&quot;&quot; Instantiate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">c</span> <span class="o">=</span> <span class="n">Coherence</span><span class="o">.</span><span class="n">Coherence</span><span class="p">(</span><span class="n">Fs</span><span class="p">,</span> <span class="n">NFFT</span><span class="p">,</span> <span class="n">detrend</span><span class="p">,</span> <span class="n">noverlap</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in Coherence constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in Coherence constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in Coherence constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>


<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance of the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;NFFT = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">NFFT</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;detrend = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">detrend</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;noverlap= &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">noverlap</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;plot = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">plot</span><span class="p">))</span>

<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">res</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in Coherence computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in Coherence computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in Coherence computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Display result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;**************************************** </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Coherence complete result :&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s">&#39;Coherence&#39;</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s">&#39;Frequency&#39;</span><span class="p">])</span>

<span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Push ENTER key to exit.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="correlation-example">
<h3><a class="toc-backref" href="#id7">Correlation example</a><a class="headerlink" href="#correlation-example" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference download internal" href="_downloads/Correlation.py"><tt class="xref download docutils literal"><span class="pre">Source</span> <span class="pre">code</span></tt></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Correlation example:</span>
<span class="sd">It computes the linear correlation between two continuous univariate signals x and y (in pandas DataFrame format) as a function of their delay tau.</span>
<span class="sd">It computes autocorrelation when y coincides with x. </span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Import common python packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>      <span class="c"># Mathematical package</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>     <span class="c"># Time serie package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span> <span class="c"># Plotting package</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;../src/&#39;</span><span class="p">)</span>   <span class="c"># To be able to import packages from parent directory </span>

<span class="k">print</span> <span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;***********************************************************************************************************************&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;This scripts computes the correlation between two univariate signals.&quot;</span>
       <span class="s">&quot;First input is a sinewave of 1 Hz frequency, the second one</span><span class="se">\n</span><span class="s"> is the sum of this sinewave&quot;</span>
       <span class="s">&quot;with a gaussian random process having zero mean and unitary</span><span class="se">\n</span><span class="s"> variance.&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;************************************************************************************************************************&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Import wanted module with every parent packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">DataFrom2Persons.Univariate.Continuous.Linear.Correlation</span> <span class="kn">as</span> <span class="nn">Correlation</span>

<span class="sd">&quot;&quot;&quot; Import Utils modules &quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">Standardize</span>
<span class="kn">from</span> <span class="nn">utils.ExtractSignal</span> <span class="kn">import</span> <span class="n">ExtractSignalFromCSV</span>


<span class="sd">&quot;&quot;&quot; Define signals in pd.dataFrame format &quot;&quot;&quot;</span>

<span class="c">#Define parameters</span>
<span class="n">N</span><span class="o">=</span><span class="mi">1024</span> <span class="c"># number of samples</span>
<span class="n">f</span><span class="o">=</span><span class="mf">1.0</span>  <span class="c"># sinewave frequency (Hz)</span>
<span class="n">Fs</span><span class="o">=</span><span class="mi">200</span> <span class="c"># sampling frequency (Hz)</span>

<span class="n">n</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="c">#number of samples</span>

<span class="c"># Create signals</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mf">3.14</span><span class="o">*</span><span class="n">f</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="n">Fs</span><span class="p">)},</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;Y&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mf">3.14</span><span class="o">*</span><span class="n">f</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="n">Fs</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)[</span><span class="mi">0</span><span class="p">]},</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>


<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">&quot;&quot;&quot;OR&quot;&quot;&quot;</span>
<span class="sd">&quot;&quot;&quot; Import signals from a .csv file &quot;&quot;&quot;</span>
<span class="sd">#Data from files</span>
<span class="sd">filename = &#39;data_examples/2Persons_Univariate_Continuous_data.csv&#39;</span>

<span class="sd">x = ExtractSignalFromCSV(filename, columns = [&#39;x1&#39;])</span>
<span class="sd">y = ExtractSignalFromCSV(filename, columns = [&#39;x2&#39;])</span>
<span class="sd">n=np.arange(0,x.shape[0])</span>
<span class="sd">&#39;&#39;&#39;</span>



<span class="sd">&quot;&quot;&quot;Plot input signals&quot;&quot;&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">f</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Input signals&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>

<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">)</span>



<span class="sd">&quot;&quot;&quot; Define class attributes of the wanted method &quot;&quot;&quot;</span>

<span class="n">tau_max</span> <span class="o">=</span> <span class="mi">999</span>                       <span class="c"># the maximum lag at which correlation should be computed (in samples)</span>
<span class="n">plot</span><span class="o">=</span><span class="bp">True</span>                           <span class="c"># plot of the correlation fucntion</span>
<span class="n">standardization</span> <span class="o">=</span> <span class="bp">True</span>              <span class="c"># standardization of the time series to mean 0 and variance 1</span>
<span class="n">corr_tau_max</span> <span class="o">=</span> <span class="bp">True</span>                 <span class="c"># return of the maximum of correlation and its lag</span>
<span class="n">corr_coeff</span> <span class="o">=</span> <span class="bp">True</span>                   <span class="c"># computation of the correlation coefficient (Pearson&#39;s version)</span>
<span class="n">scale</span><span class="o">=</span><span class="bp">True</span>                          <span class="c"># scale factor to have correlaton in [-1,1]</span>

<span class="sd">&quot;&quot;&quot; Instantiate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">c</span><span class="o">=</span><span class="n">Correlation</span><span class="o">.</span><span class="n">Correlation</span><span class="p">(</span><span class="n">tau_max</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">standardization</span><span class="p">,</span> <span class="n">corr_tau_max</span><span class="p">,</span> <span class="n">corr_coeff</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in Correlation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in Correlation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in Correlation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance of the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;tau max = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tau_max</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;plot = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">plot</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;standardization= &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">standardization</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;corr_tau_max = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">corr_tau_max</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;corr_coeff =&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">corr_coeff</span><span class="p">)</span> <span class="o">+</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;scale =&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">scale</span><span class="p">))</span>

<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">res</span><span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in Correlation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in Correlation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in Correlation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Display result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;**************************************** </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Correlation complete result :&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Correlation function array:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s">&#39;corr_funct&#39;</span><span class="p">])</span>

<span class="k">if</span> <span class="n">corr_tau_max</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Maximum value of the correlation </span><span class="si">%f</span><span class="s"> and lag (in samples) </span><span class="si">%d</span><span class="s">:&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s">&#39;max_corr&#39;</span><span class="p">],</span><span class="n">res</span><span class="p">[</span><span class="s">&#39;t_max&#39;</span><span class="p">]))</span>

<span class="k">if</span> <span class="n">corr_coeff</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Pearson&#39;s correlation coefficient </span><span class="si">%f</span><span class="s">:&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s">&#39;corr_coeff&#39;</span><span class="p">]))</span>



<span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Push ENTER key to exit.&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s">&quot;all&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="granger-causality-example">
<h3><a class="toc-backref" href="#id8">Granger Causality example</a><a class="headerlink" href="#granger-causality-example" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference download internal" href="_downloads/GrangerCausality.py"><tt class="xref download docutils literal"><span class="pre">Source</span> <span class="pre">code</span></tt></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">GrangerCausality example :</span>
<span class="sd">Computes a Granger Causality test between two continuous univariate signals x and y that are stored as pandas DataFrame</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Import common python packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>              <span class="c"># Mathematical package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span> <span class="c"># Plotting package</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;../src/&#39;</span><span class="p">)</span>       <span class="c"># To be able to import from parent directory</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;*************************************************************************************&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;This script computes the Granger Causality test between two univariate signals </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;in pandas DataFrame format.&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;*************************************************************************************&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Import Utils modules &quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">utils.ExtractSignal</span> <span class="kn">import</span> <span class="n">ExtractSignalFromCSV</span>
<span class="kn">from</span> <span class="nn">utils.ResampleAndInterpolate</span> <span class="kn">import</span> <span class="n">ResampleAndInterpolate</span>

<span class="sd">&quot;&quot;&quot; Import wanted module with every parent packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">DataFrom2Persons.Univariate.Continuous.Linear.GrangerCausality</span> <span class="kn">as</span> <span class="nn">GC</span>

<span class="sd">&quot;&quot;&quot; Import signal from a .csv file &quot;&quot;&quot;</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s">&#39;data_examples/2Persons_Univariate_Continuous_data.csv&#39;</span>
<span class="k">print</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Loading signals from csv files : &quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">ExtractSignalFromCSV</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;x1&#39;</span><span class="p">])</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">ExtractSignalFromCSV</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;x2&#39;</span><span class="p">])</span>

<span class="c"># Resample and Interpolate data to have constant frequency</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">ResampleAndInterpolate</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="s">&#39;200ms&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">ResampleAndInterpolate</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="s">&#39;200ms&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Plot input signals &quot;&quot;&quot;</span>
<span class="n">Signals</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>

<span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Signals</span><span class="p">)</span>
<span class="n">figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span>  <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Signals</span><span class="p">))</span> <span class="p">:</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span> <span class="c"># Display a grid</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Input signal : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Signals</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Signals</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">Signals</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
    
<span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Time&#39;</span><span class="p">)</span>


<span class="sd">&quot;&quot;&quot; Define class attributes &quot;&quot;&quot;</span>
<span class="n">max_lag</span> <span class="o">=</span> <span class="mi">3</span> 			<span class="c"># Define the maximum lag acceptable to estimate autoregressive models</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="s">&#39;bic&#39;</span>   	<span class="c"># Define the criterion to estimate the optimal number of lags to estimate autoregressive models</span>
<span class="n">plot</span> <span class="o">=</span> <span class="bp">True</span>				<span class="c"># Authorize the plot of the results</span>

<span class="sd">&quot;&quot;&quot; Instantiate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
	<span class="n">gc</span> <span class="o">=</span> <span class="n">GC</span><span class="o">.</span><span class="n">GrangerCausality</span><span class="p">(</span><span class="n">max_lag</span> <span class="o">=</span> <span class="n">max_lag</span><span class="p">,</span> <span class="n">criterion</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">,</span> <span class="n">plot</span> <span class="o">=</span> <span class="n">plot</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in GrangerCausality constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in GrangerCausality constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in GrangerCausality constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance of the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
		<span class="s">&quot;max_lag = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">max_lag</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
		<span class="s">&quot;criterion = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">criterion</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
		<span class="s">&quot;plot = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">plot</span><span class="p">))</span>
	
<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
	<span class="n">results</span> <span class="o">=</span> <span class="n">gc</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in GrangerCausality computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in GrangerCausality computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in GrangerCausality computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c"># Displaying results :</span>
<span class="k">print</span> <span class="s">&quot;Computing autoregressive model &#39;restricted&#39; and &#39;unrestricted&#39; via the &#39;Ordinary Least Squares&#39; method</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="k">print</span> <span class="s">&quot;According to&quot;</span><span class="p">,</span><span class="n">criterion</span><span class="p">,</span><span class="s">&quot;, the optimal number of lag estimated is :&quot;</span><span class="p">,</span> <span class="n">results</span><span class="p">[</span><span class="s">&#39;optimal_lag&#39;</span><span class="p">],</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="k">print</span> <span class="s">&quot;F_value =&quot;</span><span class="p">,</span><span class="n">results</span><span class="p">[</span><span class="s">&#39;F_value&#39;</span><span class="p">],</span><span class="s">&quot; with p_value =&quot;</span><span class="p">,</span><span class="n">results</span><span class="p">[</span><span class="s">&#39;p_value&#39;</span><span class="p">],</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="k">print</span> <span class="s">&quot;ratio value=&quot;</span><span class="p">,</span><span class="n">results</span><span class="p">[</span><span class="s">&#39;ratio&#39;</span><span class="p">],</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>

<span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Push ENTER key to exit.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="spectral-granger-causality-example">
<h3><a class="toc-backref" href="#id9">Spectral Granger Causality example</a><a class="headerlink" href="#spectral-granger-causality-example" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference download internal" href="_downloads/SpectralGrangerCausality.py"><tt class="xref download docutils literal"><span class="pre">Source</span> <span class="pre">code</span></tt></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">SpectralGrangerCausality example :</span>
<span class="sd">Computes a Spectral Granger Causality test between two signals x and y that are stored as a DataFrame</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Import common python packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>              <span class="c"># Mathematical package</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>             <span class="c"># Time serie package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span> <span class="c"># Plotting package</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;../src/&#39;</span><span class="p">)</span>       <span class="c"># To be able to import from parent directory</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;*************************************************************************************&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;This script computes the Granger Causality test in the spectral domain between two monovariate signals </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;expressed as Python Pandas DataFrame.&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;*************************************************************************************&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Import Utils modules &quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">utils.ExtractSignal</span> <span class="kn">import</span> <span class="n">ExtractSignalFromCSV</span>
<span class="kn">from</span> <span class="nn">utils.ResampleAndInterpolate</span> <span class="kn">import</span> <span class="n">ResampleAndInterpolate</span>

<span class="sd">&quot;&quot;&quot; Import wanted module with every parent packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">DataFrom2Persons.Univariate.Continuous.Linear.SpectralGrangerCausality</span> <span class="kn">as</span> <span class="nn">SGC</span>

<span class="sd">&quot;&quot;&quot; Import signal from a .csv file &quot;&quot;&quot;</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s">&#39;data_examples/1Person_Multivariate_Continuous_data.csv&#39;</span>
<span class="k">print</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Loading signals from csv files : &quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">ExtractSignalFromCSV</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;x2&#39;</span><span class="p">])</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">ExtractSignalFromCSV</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;x3&#39;</span><span class="p">])</span>
<span class="sd">&quot;&quot;&quot; Define class attributes &quot;&quot;&quot;</span>
<span class="n">max_lag</span> <span class="o">=</span><span class="mi">10</span>	<span class="c"># Define the maximum lag acceptable to estimate autoregressive models</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="s">&#39;bic&#39;</span>	<span class="c"># Define the criterion to estimate the optimal number of lags to estimate autoregressive models</span>
<span class="n">plot</span> <span class="o">=</span> <span class="bp">True</span>		<span class="c"># Authorize the plot of the results</span>

<span class="sd">&quot;&quot;&quot; Instanciate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
	<span class="n">sgc</span> <span class="o">=</span> <span class="n">SGC</span><span class="o">.</span><span class="n">SpectralGrangerCausality</span><span class="p">(</span><span class="n">max_lag</span> <span class="o">=</span> <span class="n">max_lag</span><span class="p">,</span> <span class="n">criterion</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">,</span> <span class="n">plot</span> <span class="o">=</span> <span class="n">plot</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in SpectralGrangerCausality constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in SpectralGrangerCausality constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in SpectralGrangerCausality constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance of the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
		<span class="s">&quot;max_lag = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">max_lag</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
		<span class="s">&quot;criterion = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">criterion</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
		<span class="s">&quot;plot = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">plot</span><span class="p">))</span>
<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">try</span> <span class="p">:</span> 
	<span class="n">results</span> <span class="o">=</span> <span class="n">sgc</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in SpectralGrangerCausality computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in SpectralGrangerCausality computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in SpectralGrangerCausality computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>


<span class="c"># Displaying results :</span>
<span class="k">print</span> <span class="s">&quot;Computing autoregressive model &#39;restricted&#39; and &#39;unrestricted&#39; via the &#39;Ordinary Least Squares&#39; method</span><span class="se">\n</span><span class="s">&quot;</span>

<span class="k">print</span> <span class="s">&quot;According to&quot;</span><span class="p">,</span><span class="n">sgc</span><span class="o">.</span><span class="n">_criterion</span><span class="p">,</span><span class="s">&quot;, the optimal number of lag estimated is :&quot;</span><span class="p">,</span> <span class="n">sgc</span><span class="o">.</span><span class="n">_olag</span><span class="p">,</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>

<span class="k">print</span> <span class="s">&quot;Printing RESULTS  ...</span><span class="se">\n</span><span class="s">&quot;</span>

<span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Push ENTER key to exit.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="window-cross-correlation-example">
<h3><a class="toc-backref" href="#id10">Window Cross Correlation example</a><a class="headerlink" href="#window-cross-correlation-example" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference download internal" href="_downloads/WindowCrossCorrelation.py"><tt class="xref download docutils literal"><span class="pre">Source</span> <span class="pre">code</span></tt></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">WindowCrossCorrelation example :</span>
<span class="sd">Computes the window cross correlation between two continuous univariate signals x and y (in pandas DataFrame format)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Import common python packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>              <span class="c"># Mathematical package</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>             <span class="c"># Time serie package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span> <span class="c"># Plotting package</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;../src/&#39;</span><span class="p">)</span>       <span class="c"># To be able to import from parent directory</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;*************************************************************************************&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;This script computes the windowed cross-correlation between two continuous monovariate signals </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;expressed as Python Pandas DataFrame.&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;*************************************************************************************&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Import wanted module with every parent packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">DataFrom2Persons.Univariate.Continuous.Linear.WindowCrossCorrelation</span> <span class="kn">as</span> <span class="nn">WindowCrossCorrelation</span>

<span class="sd">&quot;&quot;&quot; Import Utils modules &quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">utils.ExtractSignal</span> <span class="kn">import</span> <span class="n">ExtractSignalFromCSV</span>
<span class="kn">from</span> <span class="nn">utils.ExtractSignal</span> <span class="kn">import</span> <span class="n">ExtractSignalFromMAT</span>
<span class="kn">from</span> <span class="nn">utils.ResampleAndInterpolate</span> <span class="kn">import</span> <span class="n">ResampleAndInterpolate</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">&quot;&quot;&quot; Define signals in pd.dataFrame format &quot;&quot;&quot;</span>
<span class="sd"># preparing the input time series</span>
<span class="sd">N = 20             # number of samples</span>
<span class="sd">f = 1.0             # sinewave frequency (Hz)</span>
<span class="sd">Fs = 200            # sampling frequency (Hz)</span>
<span class="sd">n = np.arange(0,N)  # number of samples</span>
<span class="sd"># input time series</span>
<span class="sd">x = pd.DataFrame({&#39;X&#39;:np.sin(2*3.14*f*n/Fs)})</span>
<span class="sd">y = pd.DataFrame({&#39;Y&#39;:np.sin(2*3.14*2*f*n/Fs)})</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="sd">&quot;&quot;&quot;OR&quot;&quot;&quot;</span>
<span class="sd">&quot;&quot;&quot; Import signal from a .csv file &quot;&quot;&quot;</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s">&#39;data_examples/2Persons_Univariate_Continuous_data_2.csv&#39;</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ExtractSignalFromCSV</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">],</span> <span class="n">unit</span> <span class="o">=</span> <span class="s">&#39;s&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ExtractSignalFromCSV</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">],</span> <span class="n">unit</span> <span class="o">=</span> <span class="s">&#39;s&#39;</span><span class="p">)</span>

<span class="c"># Resample and Interpolate data to have constant frequency</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ResampleAndInterpolate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="s">&#39;500ms&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ResampleAndInterpolate</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="s">&#39;500ms&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">&quot;&quot;&quot;OR&quot;&quot;&quot;</span>
<span class="sd">&quot;&quot;&quot; Import signal from a .mat file &quot;&quot;&quot;</span>
<span class="sd">filename = &#39;data_examples/data_example_MAT.mat&#39;</span>
<span class="sd">x = ExtractSignalFromMAT(filename, columns_index =[0,2], columns_wanted_names=[&#39;Time&#39;, &#39;GlobalBodyActivity0&#39;])</span>
<span class="sd">y = ExtractSignalFromMAT(filename, columns_index =[10], columns_wanted_names=[&#39;GlobalBodyActivity1&#39;])</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="sd">&quot;&quot;&quot; Plot input signals &quot;&quot;&quot;</span>
<span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)]</span> <span class="c"># create x axis values</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Input signals&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_transform</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">transFigure</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Define class attributes of the wanted method &quot;&quot;&quot;</span>
<span class="n">tau_max</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">2</span>     <span class="c"># the maximum lag at which correlation should be computed. It is in the range [0; (lx+ly-1)/2] (in samples)</span>
<span class="n">window</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">10</span>     <span class="c"># length of the windowed signals (in samples)</span>
<span class="n">window_inc</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">2</span>  <span class="c"># amount of time elapsed between two windows (in samples)</span>
<span class="n">tau_inc</span><span class="o">=</span> <span class="mi">1</span>          <span class="c"># amount of time elapsed between two cross-correlation (in samples)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="bp">True</span>         <span class="c"># if True the plot of correlation function is returned. Default: False</span>
<span class="n">ele_per_sec</span> <span class="o">=</span> <span class="mi">5</span>     <span class="c"># number of element in one second</span>

<span class="sd">&quot;&quot;&quot; Instantiate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">try</span> <span class="p">:</span> 
    <span class="n">corr</span> <span class="o">=</span> <span class="n">WindowCrossCorrelation</span><span class="o">.</span><span class="n">WindowCrossCorrelation</span><span class="p">(</span><span class="n">tau_max</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">window_inc</span><span class="p">,</span> <span class="n">tau_inc</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">ele_per_sec</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in WindowCrossCorrelation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in WindowCrossCorrelation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in WindowCrossCorrelation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance of the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;tau max = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tau_max</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;window length = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">window</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;window increment = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">window_inc</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;tau increment = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">window_inc</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;number of element per second = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ele_per_sec</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;plot result = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">plot</span><span class="p">))</span>

<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">cross_corr</span> <span class="o">=</span> <span class="n">corr</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in WindowCrossCorrelation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in WindowCrossCorrelation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in WindowCrossCorrelation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Display result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;********************************* </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Window Cross correlation result :&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;********************************* </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">cross_corr</span><span class="p">)</span>

<span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Push ENTER key to exit.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="window-cross-correlation-with-peakpicking-example">
<h3><a class="toc-backref" href="#id11">Window Cross Correlation with PeakPicking example</a><a class="headerlink" href="#window-cross-correlation-with-peakpicking-example" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference download internal" href="_downloads/WindowCrossCorrelation_with_PeakPicking.py"><tt class="xref download docutils literal"><span class="pre">Source</span> <span class="pre">code</span></tt></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">PeakPicking example :</span>
<span class="sd">Computes peak picking algorithm with window cross correlation results</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Import common python packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>          <span class="c"># Mathematical package</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>         <span class="c"># Time serie package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span> <span class="c"># Plotting package</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;../src/&#39;</span><span class="p">)</span>   <span class="c"># To be able to import from parent directory </span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;*****************************************************************************&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;This script computes the peak picking selection of a cross correlation matrix </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;*****************************************************************************&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Import wanted modules with every parent packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">DataFrom2Persons.Univariate.Continuous.Linear.WindowCrossCorrelation</span> <span class="kn">as</span> <span class="nn">WindowCrossCorrelation</span>


<span class="sd">&quot;&quot;&quot; Import Utils modules &quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">utils.ExtractSignal</span> <span class="kn">import</span> <span class="n">ExtractSignalFromCSV</span>
<span class="kn">from</span> <span class="nn">utils.ExtractSignal</span> <span class="kn">import</span> <span class="n">ExtractSignalFromMAT</span>
<span class="kn">from</span> <span class="nn">utils.ResampleAndInterpolate</span> <span class="kn">import</span> <span class="n">ResampleAndInterpolate</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">PeakPicking</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">&quot;&quot;&quot; Define signals in pd.dataFrame format &quot;&quot;&quot;</span>
<span class="sd"># preparing the input signals</span>
<span class="sd">N = 20             # number of samples</span>
<span class="sd">f = 1.0             # sinewave frequency (Hz)</span>
<span class="sd">Fs = 200            # sampling frequency (Hz)</span>
<span class="sd">n = np.arange(0,N)  # number of samples</span>
<span class="sd"># input signals</span>
<span class="sd">x = pd.DataFrame({&#39;X&#39;:np.sin(2*3.14*f*n/Fs)})</span>
<span class="sd">y = pd.DataFrame({&#39;Y&#39;:np.sin(2*3.14*2*f*n/Fs)})</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="sd">&quot;&quot;&quot;OR&quot;&quot;&quot;</span>
<span class="sd">&quot;&quot;&quot; Import signals from a .csv file &quot;&quot;&quot;</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s">&#39;data_examples/2Persons_Univariate_Continuous_data_2.csv&#39;</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ExtractSignalFromCSV</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">],</span> <span class="n">unit</span> <span class="o">=</span> <span class="s">&#39;s&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ExtractSignalFromCSV</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">],</span> <span class="n">unit</span> <span class="o">=</span> <span class="s">&#39;s&#39;</span><span class="p">)</span>

<span class="c"># Resample and Interpolate data to have constant frequency</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ResampleAndInterpolate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="s">&#39;500ms&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ResampleAndInterpolate</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="s">&#39;500ms&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">&quot;&quot;&quot;OR&quot;&quot;&quot;</span>
<span class="sd">&quot;&quot;&quot; Import signals from a .mat file &quot;&quot;&quot;</span>
<span class="sd">filename = &#39;data_examples/data_example_MAT.mat&#39;</span>
<span class="sd">x = ExtractSignalFromMAT(filename, columns_index =[0,2], columns_wanted_names=[&#39;Time&#39;, &#39;GlobalBodyActivity0&#39;])</span>
<span class="sd">y = ExtractSignalFromMAT(filename, columns_index =[10], columns_wanted_names=[&#39;GlobalBodyActivity1&#39;])</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="sd">&quot;&quot;&quot; Plot input signals &quot;&quot;&quot;</span>
<span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)]</span> <span class="c"># create x axis values</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Input signals&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_transform</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">transFigure</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Define class attributes of the wanted method &quot;&quot;&quot;</span>
<span class="n">tau_max</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">2</span>     <span class="c"># the maximum lag at which correlation should be computed. It is in the range [0; (lx+ly-1)/2] (in samples)</span>
<span class="n">window</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">10</span>     <span class="c"># length of the windowed signals (in samples)</span>
<span class="n">window_inc</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">2</span>  <span class="c"># amount of time elapsed between two windows (in samples)</span>
<span class="n">tau_inc</span><span class="o">=</span> <span class="mi">1</span>          <span class="c"># amount of time elapsed between two cross-correlation (in samples)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="bp">True</span>         <span class="c"># if True the plot of correlation function is returned. Default: False</span>
<span class="n">ele_per_sec</span> <span class="o">=</span> <span class="mi">5</span>     <span class="c"># number of element in one second</span>

<span class="sd">&quot;&quot;&quot; Instanciate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">try</span> <span class="p">:</span> 
    <span class="n">corr</span> <span class="o">=</span> <span class="n">WindowCrossCorrelation</span><span class="o">.</span><span class="n">WindowCrossCorrelation</span><span class="p">(</span><span class="n">tau_max</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">window_inc</span><span class="p">,</span> <span class="n">tau_inc</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">ele_per_sec</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in WindowCrossCorrelation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in WindowCrossCorrelation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in WindowCrossCorrelation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">try</span> <span class="p">:</span> 
    <span class="n">cross_corr</span> <span class="o">=</span> <span class="n">corr</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in WindowCrossCorrelation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in WindowCrossCorrelation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in WindowCrossCorrelation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Get peaks of current result &quot;&quot;&quot;</span>
<span class="n">tau_max</span> <span class="o">=</span> <span class="mi">10</span>        <span class="c"># the maximum lag at which correlation should be computed. It is in the range [0; (lx+ly-1)/2] (in samples)</span>
<span class="n">tau_inc</span><span class="o">=</span> <span class="mi">1</span>          <span class="c"># amount of time elapsed between two cross-correlation (in samples)</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.5</span>     <span class="c"># minimal correlation magnitude acceptable for a peak (between -1 and 1)</span>
<span class="n">lookahead</span> <span class="o">=</span> <span class="mi">2</span>       <span class="c"># distance to look ahead from a peak candidate to determine if it is the actual peak. Default: 200</span>
<span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span>           <span class="c"># this specifies a minimum difference between a peak and the following points, before a peak may be considered a peak. Default: 0</span>
<span class="n">ele_per_sec</span> <span class="o">=</span> <span class="mi">2</span>     <span class="c"># number of element in one second</span>
<span class="n">plot</span> <span class="o">=</span> <span class="bp">False</span>        <span class="c">#if True the plot of peakpicking function is returned. Default: False</span>
<span class="n">plot_on_mat</span> <span class="o">=</span><span class="bp">False</span>  <span class="c"># if True the plot of peakpicking + correlation matrix function is returned. Default: False</span>
<span class="n">sorted_peak</span> <span class="o">=</span> <span class="bp">False</span> <span class="c"># if True the peaks found will be organized by type of Lag and Magnitude (positive or negative). Default: False</span>

<span class="c"># Compute peakPicking util method</span>
<span class="k">try</span> <span class="p">:</span> 
    <span class="n">peak_res</span> <span class="o">=</span> <span class="n">PeakPicking</span><span class="o">.</span><span class="n">PeakPicking</span><span class="p">(</span><span class="n">cross_corr</span><span class="p">,</span> <span class="n">tau_max</span><span class="p">,</span> <span class="n">tau_inc</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">lookahead</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">ele_per_sec</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">plot_on_mat</span><span class="p">,</span> <span class="n">sorted_peak</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in PeakPicking method : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in PeakPicking method : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in PeakPicking method : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c"># Get figure </span>
<span class="k">try</span> <span class="p">:</span> 
    <span class="n">peak_figure</span> <span class="o">=</span> <span class="n">PeakPicking</span><span class="o">.</span><span class="n">PeakPicking_plot</span><span class="p">(</span><span class="n">peak_res</span><span class="p">,</span> <span class="n">cross_corr</span><span class="p">,</span> <span class="n">tau_max</span><span class="p">,</span> <span class="n">ele_per_sec</span><span class="p">,</span> <span class="n">plot_on_mat</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in PeakPicking computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in PeakPicking computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in PeakPicking computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c"># Get stats </span>
<span class="n">peak_sorted</span> <span class="o">=</span> <span class="n">PeakPicking</span><span class="o">.</span><span class="n">PeakPicking_sortResult</span><span class="p">(</span><span class="n">peak_res</span><span class="p">)</span><span class="c"># Get statistics</span>

<span class="sd">&quot;&quot;&quot; Display result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;********************* </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Peak Picking result : &#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;********************* </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">peak_sorted</span><span class="p">)</span>

<span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Push ENTER key to exit.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="datafrom2persons-univariate-continuous-nonlinear-module">
<h2><a class="toc-backref" href="#id12">DataFrom2Persons Univariate Continuous NonLinear module</a><a class="headerlink" href="#datafrom2persons-univariate-continuous-nonlinear-module" title="Permalink to this headline">¶</a></h2>
<div class="section" id="nonlinear-correlation-example">
<h3><a class="toc-backref" href="#id13">Nonlinear Correlation example</a><a class="headerlink" href="#nonlinear-correlation-example" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference download internal" href="_downloads/NonlinearCorr.py"><tt class="xref download docutils literal"><span class="pre">Source</span> <span class="pre">code</span></tt></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Nonlinear Correlation example :</span>
<span class="sd">It computes the nonparametric nonlinear regression coefficient h2 describing the dependency</span>
<span class="sd">between two continouos univariate signals x and y (in pandas DataFrame format)in a most general way.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Import common python packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>          <span class="c"># Mathematical package</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>         <span class="c"># Time serie package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span> <span class="c"># Plotting package</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;../src/&#39;</span><span class="p">)</span>   <span class="c"># To be able to import packages from parent directory </span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;**************************************************************&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;This script computes the nonlinear correlation coefficient </span><span class="se">\n</span><span class="s">&quot;</span><span class="o">+</span>
      <span class="s">&quot;of two continouos univariate signals </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;**************************************************************&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Import wanted module with every parent packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">DataFrom2Persons.Univariate.Continuous.Nonlinear.NonlinearCorr</span> <span class="kn">as</span> <span class="nn">NonlinearCorr</span>
<span class="kn">from</span> <span class="nn">utils.ExtractSignal</span> <span class="kn">import</span> <span class="n">ExtractSignalFromCSV</span>
<span class="kn">from</span> <span class="nn">DataFrom2Persons.Univariate.Continuous.Linear</span> <span class="kn">import</span> <span class="n">Correlation</span>



<span class="sd">&quot;&quot;&quot; Define signals in pd.dataFrame format &quot;&quot;&quot;</span>

<span class="c">#Define parameters</span>
<span class="n">N</span><span class="o">=</span><span class="mi">1000</span>                     <span class="c"># number of samples</span>
<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="c"># number of samples</span>


<span class="c">#Create signals</span>
<span class="n">x</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span><span class="mf">3.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mf">0.0001</span><span class="p">)},</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="n">y</span><span class="o">=</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>



<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">&quot;&quot;&quot;OR&quot;&quot;&quot;</span>
<span class="sd">&quot;&quot;&quot; Import signals from a .csv file &quot;&quot;&quot;</span>
<span class="sd">#Data from files</span>
<span class="sd">filename = &#39;data_examples/2Persons_Univariate_Continuous_data.csv&#39;</span>

<span class="sd">x = ExtractSignalFromCSV(filename, columns = [&#39;x1&#39;])</span>
<span class="sd">y = ExtractSignalFromCSV(filename, columns = [&#39;x2&#39;])</span>
<span class="sd">&#39;&#39;&#39;</span>


<span class="sd">&quot;&quot;&quot; Plot input signals&quot;&quot;&quot;</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">f</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Input signals&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">)</span>



<span class="sd">&quot;&quot;&quot; Define class attributes of the wanted method &quot;&quot;&quot;</span>
<span class="n">nbins</span><span class="o">=</span><span class="mi">100</span>   <span class="c"># number of bins in which the time series is divided into</span>


<span class="sd">&quot;&quot;&quot; Instanciate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">c</span> <span class="o">=</span> <span class="n">NonlinearCorr</span><span class="o">.</span><span class="n">NonlinearCorr</span><span class="p">(</span><span class="n">nbins</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in NonlinearCorr constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in NonlinearCorr constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in NonlinearCorr constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>


<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance of the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;number of bin = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nbins</span><span class="p">))</span>

<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">res</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in NonlinearCorr computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in NonlinearCorr computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in NonlinearCorr computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Display result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;**************************************** </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;NonlinearCorr complete result :</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s">&#39;h2 coefficient&#39;</span><span class="p">])</span>

<span class="sd">&quot;&quot;&quot; Computing the linear correlation coeffcient&quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&quot;Computing the linear correlation coefficient:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot; Define class attributes of the wanted method &quot;&quot;&quot;</span>

<span class="n">tau_max</span> <span class="o">=</span> <span class="mi">999</span>                       <span class="c"># the maximum lag at which correlation should be computed (in samples)</span>
<span class="n">plot</span><span class="o">=</span><span class="bp">False</span>                          <span class="c"># plot of the correlation fucntion</span>
<span class="n">standardization</span> <span class="o">=</span> <span class="bp">True</span>              <span class="c"># standardization of the time series to mean 0 and variance 1</span>
<span class="n">corr_tau_max</span> <span class="o">=</span> <span class="bp">False</span>                <span class="c"># return of the maximum of correlation and its lag</span>
<span class="n">corr_coeff</span> <span class="o">=</span> <span class="bp">True</span>                   <span class="c"># computation of the correlation coefficient (Pearson&#39;s version)</span>
<span class="n">scale</span><span class="o">=</span> <span class="bp">False</span>                        <span class="c"># scale factor to have correlaton in [-1,1]</span>

<span class="sd">&quot;&quot;&quot; Instantiate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">c</span><span class="o">=</span><span class="n">Correlation</span><span class="o">.</span><span class="n">Correlation</span><span class="p">(</span><span class="n">tau_max</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">standardization</span><span class="p">,</span> <span class="n">corr_tau_max</span><span class="p">,</span> <span class="n">corr_coeff</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in Correlation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in Correlation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in Correlation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance of the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;tau max = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tau_max</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;plot = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">plot</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;standardization= &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">standardization</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;corr_tau_max = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">corr_tau_max</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;corr_coeff =&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">corr_coeff</span><span class="p">)</span> <span class="o">+</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;scale =&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">scale</span><span class="p">))</span>

<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">res</span><span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in Correlation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in Correlation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in Correlation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Display result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;**************************************** </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Correlation complete result :</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Pearson&#39;s correlation coefficient </span><span class="si">%f</span><span class="s">:&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s">&#39;corr_coeff&#39;</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">print</span> <span class="p">(</span><span class="s">&quot;As expected, the two coefficients provide different results:, </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
       <span class="s">&quot;that is high value of nonlinear correlation coefficient and </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
       <span class="s">&quot;low value of linear correlation coefficient.&quot;</span><span class="p">)</span>


<span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Push ENTER key to exit.&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s">&quot;all&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="mutual-information-example">
<h3><a class="toc-backref" href="#id14">Mutual Information example</a><a class="headerlink" href="#mutual-information-example" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference download internal" href="_downloads/MutualInformation.py"><tt class="xref download docutils literal"><span class="pre">Source</span> <span class="pre">code</span></tt></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Mutual Information example:</span>
<span class="sd">It Computes Mutual Information (MI) estimators starting from entropy estimates from k-nearest-neighbours distances.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Import common python packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>              <span class="c"># Mathematical package</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>             <span class="c"># Time serie package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span> <span class="c"># Plotting package</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;../src/&#39;</span><span class="p">)</span>   <span class="c"># To be able to import packages from parent directory </span>

<span class="k">print</span> <span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;This scripts computes two Mutual Information estimators from signals </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;by using k-nearest-neighbours approach.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Import wanted module with every parent packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">DataFrom2Persons.Univariate.Continuous.Nonlinear.MutualInformation</span> <span class="kn">as</span> <span class="nn">MutualInformation</span>

<span class="sd">&quot;&quot;&quot; Import Utils modules &quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">utils.ExtractSignal</span> <span class="kn">import</span> <span class="n">ExtractSignalFromCSV</span>


<span class="sd">&quot;&quot;&quot; Define signals in pd.dataFrame format &quot;&quot;&quot;</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&quot;Two independent uniformly distributed signals: Mi estimator should be </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> 
       <span class="s">&quot;around 0 (negative values are due to statistical fluctuations)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="c"># Create signals</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mf">1.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mf">1.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">&quot;&quot;&quot;OR&quot;&quot;&quot;</span>
<span class="sd">&quot;&quot;&quot; Import signals from a .csv file &quot;&quot;&quot;</span>
<span class="sd">#Data from files</span>
<span class="sd">filename = &#39;data_examples/2Persons_Univariate_Continuous_data.csv&#39;</span>

<span class="sd">x = ExtractSignalFromCSV(filename, columns = [&#39;x1&#39;])</span>
<span class="sd">y = ExtractSignalFromCSV(filename, columns = [&#39;x2&#39;])</span>
<span class="sd">n = x.shape[0]</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="sd">&quot;&quot;&quot;Plot input signals&quot;&quot;&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">f</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Input signals&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">)</span>


<span class="sd">&quot;&quot;&quot; Define class attributes of the wanted method &quot;&quot;&quot;</span>
<span class="n">n_neighbours</span> <span class="o">=</span> <span class="mi">10</span>                   <span class="c"># the number of the nearest neighbours to be used</span>
<span class="n">my_type</span> <span class="o">=</span> <span class="mi">1</span>                         <span class="c"># the type of estimators</span>
<span class="n">var_res</span> <span class="o">=</span> <span class="bp">True</span>                      <span class="c"># rescaling of the time series</span>
<span class="n">noise</span> <span class="o">=</span> <span class="bp">True</span>                        <span class="c"># adding random noise to the time series</span>


<span class="sd">&quot;&quot;&quot; Instanciate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">c</span><span class="o">=</span><span class="n">MutualInformation</span><span class="o">.</span><span class="n">MutualInformation</span><span class="p">(</span><span class="n">n_neighbours</span><span class="p">,</span><span class="n">var_res</span><span class="p">,</span><span class="n">noise</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in MutualInformation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in MutualInformation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in MutualInformation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;n_neighbours = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_neighbours</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;my_type = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">my_type</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;var_res = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">var_res</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;noise = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">noise</span><span class="p">))</span>

<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">res1</span><span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in MutualInformation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in MutualInformation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in MutualInformation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; OTHER TRY WITH my_type = 2 &quot;&quot;&quot;</span>
<span class="n">my_type</span> <span class="o">=</span> <span class="mi">2</span>

<span class="sd">&quot;&quot;&quot; Instanciate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">c</span><span class="o">=</span><span class="n">MutualInformation</span><span class="o">.</span><span class="n">MutualInformation</span><span class="p">(</span><span class="n">n_neighbours</span><span class="p">,</span><span class="n">var_res</span><span class="p">,</span><span class="n">noise</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in MutualInformation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in MutualInformation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in MutualInformation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;n_neighbours = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_neighbours</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;my_type = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">my_type</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;var_res = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">var_res</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;noise = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">noise</span><span class="p">))</span>

<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">res2</span><span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in MutualInformation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in MutualInformation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in MutualInformation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>


<span class="sd">&quot;&quot;&quot; Display results &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;MutualInformation complete result 1:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;MutualInformation estimator 1:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;MutualInformation estimator 2:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res2</span><span class="p">)</span>

<span class="c">#mixing matrix</span>
<span class="n">C</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="k">print</span> <span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;************************************************************************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&quot;We add some dependenty to the time series (new times series are linear combination of x and y):</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
       <span class="s">&quot;Mi estimator should be now greater than 0 </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;************************************************************************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Define class attributes of the wanted method &quot;&quot;&quot;</span>

<span class="n">n_neighbours</span> <span class="o">=</span> <span class="mi">10</span>                   <span class="c"># the number of the nearest neighbours to be used</span>
<span class="n">my_type</span> <span class="o">=</span> <span class="mi">1</span>                         <span class="c"># the type of estimators</span>
<span class="n">var_res</span> <span class="o">=</span> <span class="bp">True</span>                      <span class="c"># rescaling of the time series</span>
<span class="n">noise</span> <span class="o">=</span> <span class="bp">True</span>                        <span class="c"># adding random noise to the time series</span>


<span class="sd">&quot;&quot;&quot; Instanciate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">c</span><span class="o">=</span><span class="n">MutualInformation</span><span class="o">.</span><span class="n">MutualInformation</span><span class="p">(</span><span class="n">n_neighbours</span><span class="p">,</span><span class="n">var_res</span><span class="p">,</span><span class="n">noise</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in MutualInformation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in MutualInformation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in MutualInformation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;n_neighbours = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_neighbours</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;my_type = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">my_type</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;var_res = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">var_res</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;noise = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">noise</span><span class="p">))</span>

<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">res1</span><span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in MutualInformation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in MutualInformation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in MutualInformation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
    
<span class="n">my_type</span> <span class="o">=</span> <span class="mi">2</span>

<span class="sd">&quot;&quot;&quot; Instanciate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">c</span><span class="o">=</span><span class="n">MutualInformation</span><span class="o">.</span><span class="n">MutualInformation</span><span class="p">(</span><span class="n">n_neighbours</span><span class="p">,</span><span class="n">var_res</span><span class="p">,</span><span class="n">noise</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in MutualInformation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in MutualInformation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in MutualInformation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;n_neighbours = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_neighbours</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;my_type = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">my_type</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;var_res = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">var_res</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;noise = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">noise</span><span class="p">))</span>

<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">res2</span><span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in MutualInformation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in MutualInformation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in MutualInformation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Display result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;**************************************** </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;MutualInformation complete result 2:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;MutualInformation estimator 1:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;MutualInformation estimator 2:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res2</span><span class="p">)</span>

<span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Push ENTER key to exit.&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s">&quot;all&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>^</p>
</div>
<div class="section" id="window-mutual-information-example">
<h3><a class="toc-backref" href="#id15">Window Mutual Information example</a><a class="headerlink" href="#window-mutual-information-example" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference download internal" href="_downloads/WindowMutuaInformation.py"><tt class="xref download docutils literal"><span class="pre">Source</span> <span class="pre">code</span></tt></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">WindowMututalInformation example :</span>
<span class="sd">Computes the windowed mutual information between two continuous univariate signals x and y (in pandas DataFrame format)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Import common python packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>                  <span class="c"># Mathematical package</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>                 <span class="c"># Time serie package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>     <span class="c"># Plotting package</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;../src/&#39;</span><span class="p">)</span>       <span class="c"># To be able to import from parent directory</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;***************************************************************************************&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;This script computes the windowed mutual information between two monovariate time series </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;expressed as Python Pandas DataFrame.&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;***************************************************************************************&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Import wanted module with every parent packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">DataFrom2Persons.Univariate.Continuous.Nonlinear.WindowMutualInformation</span> <span class="kn">as</span> <span class="nn">WindowMutualInformation</span>


<span class="sd">&quot;&quot;&quot; Define signals in pd.dataFrame format &quot;&quot;&quot;</span>
<span class="c"># Create signals</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mf">1.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mf">1.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>

<span class="sd">&quot;&quot;&quot; Plot input signals &quot;&quot;&quot;</span>
<span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)]</span> <span class="c"># create x axis values</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;signals&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Input signals&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span> <span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span> <span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_transform</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">transFigure</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Define class attributes of the wanted method &quot;&quot;&quot;</span>
<span class="n">n_neighbours</span> <span class="o">=</span> <span class="mi">5</span>         <span class="c"># the number of the nearest neighbours to be used</span>
<span class="n">my_type</span> <span class="o">=</span> <span class="mi">1</span>              <span class="c"># the type of estimators</span>
<span class="n">var_res</span> <span class="o">=</span> <span class="bp">True</span>           <span class="c"># rescaling of the time series</span>
<span class="n">noise</span> <span class="o">=</span> <span class="bp">True</span>             <span class="c"># adding random noise to the time series</span>

<span class="n">tau_max</span> <span class="o">=</span> <span class="mi">10</span>             <span class="c"># the maximum lag at which correlation should be computed. It is in the range [0; (lx+ly-1)/2] (in samples)</span>
<span class="n">window</span> <span class="o">=</span> <span class="mi">10</span>              <span class="c"># length of the windowed signals (in samples)</span>
<span class="n">window_inc</span> <span class="o">=</span>  <span class="mi">1</span>          <span class="c"># amount of time elapsed between two windows (in samples)</span>
<span class="n">tau_inc</span><span class="o">=</span> <span class="mi">1</span>               <span class="c"># amount of time elapsed between two cross-correlation (in samples)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="bp">True</span>              <span class="c"># if True the plot of correlation function is returned. Default: False</span>


<span class="sd">&quot;&quot;&quot; Instanciate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">try</span> <span class="p">:</span> 
    <span class="n">wmi</span> <span class="o">=</span> <span class="n">WindowMutualInformation</span><span class="o">.</span><span class="n">WindowMutualInformation</span><span class="p">(</span><span class="n">n_neighbours</span><span class="p">,</span> <span class="n">my_type</span><span class="p">,</span> <span class="n">var_res</span><span class="p">,</span><span class="n">noise</span><span class="p">,</span> <span class="n">tau_max</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">window_inc</span><span class="p">,</span> <span class="n">tau_inc</span><span class="p">,</span> <span class="n">plot</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in WindowMutualInformation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in WindowMutualInformation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in WindowMutualInformation constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;n_neighbours = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_neighbours</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;my_type = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">my_type</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;var_res = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">var_res</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;noise = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;tau max = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tau_max</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;window length = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">window</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;window increment = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">window_inc</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;tau increment = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">window_inc</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;plot result = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">plot</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">win_MI</span> <span class="o">=</span> <span class="n">wmi</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in WindowMutualInformation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in WindowMutualInformation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in WindowMutualInformation computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>


<span class="sd">&quot;&quot;&quot; Display result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;********************************* </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Window Mutual Information result :&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;********************************* </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="sd">&#39;&#39;&#39;print(win_MI)&#39;&#39;&#39;</span>

<span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Push ENTER key to exit.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="phasesynchro-strobo-example">
<h3><a class="toc-backref" href="#id16">PhaseSynchro_Strobo example</a><a class="headerlink" href="#phasesynchro-strobo-example" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference download internal" href="_downloads/PhaseSynchro_Strobo.py"><tt class="xref download docutils literal"><span class="pre">Source</span> <span class="pre">code</span></tt></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">PhaseSynchro_Strobo example :</span>
<span class="sd">It computes the n:m synchronization index lambda_nm by using a stroboscopic approach between two continuous univariate signals x and y</span>
<span class="sd">(in DataFrame format).</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Import common python packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>          <span class="c"># Mathematical package</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>         <span class="c"># Time serie package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span> <span class="c"># Plotting package</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;../src/&#39;</span><span class="p">)</span>   <span class="c"># To be able to import packages from parent directory </span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;**************************************************************&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;This script computes the n:m synchronization index lambda_nm by </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> 
      <span class="s">&quot;using a stroboscopic approach between two continuous univariate </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;signals x and y (in DataFrame format).</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;**************************************************************&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Import wanted module with every parent packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">DataFrom2Persons.Univariate.Continuous.Nonlinear.PhaseSynchro_Strobo</span> <span class="kn">as</span> <span class="nn">PhaseSynchro_Strobo</span>


<span class="sd">&quot;&quot;&quot; Define signals in pd.dataFrame format &quot;&quot;&quot;</span>

<span class="c">#Define parameters</span>
<span class="n">N</span><span class="o">=</span><span class="mi">1000</span>
<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>


<span class="n">x</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="n">y</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="mi">10</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>


<span class="sd">&quot;&quot;&quot;Plot input signals&quot;&quot;&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">f</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Input signals&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">)</span>


<span class="sd">&quot;&quot;&quot; Define class attributes of the wanted method &quot;&quot;&quot;</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>                   <span class="c"># integer of the order of synchronization</span>
<span class="n">m</span>  <span class="o">=</span> <span class="mi">1</span>                  <span class="c"># integer of the order of synchronization</span>
<span class="n">nbins_mode</span> <span class="o">=</span> <span class="s">&#39;man&#39;</span>      <span class="c"># mode used to compute the nbins number</span>
<span class="n">nbins</span> <span class="o">=</span> <span class="mi">10</span>              <span class="c"># number of bins</span>



<span class="sd">&quot;&quot;&quot; Instantiate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="o">=</span><span class="n">PhaseSynchro_Strobo</span><span class="o">.</span><span class="n">PhaseSynchro_Strobo</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">nbins_mode</span><span class="p">,</span> <span class="n">nbins</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in PhaseSynchro_Strobo constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in PhaseSynchro_Strobo constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in PhaseSynchro_Strobo constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>


<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance of the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;n = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;m = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;nbins_mode = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nbins_mode</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;nbins = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nbins</span><span class="p">))</span>


<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">res</span><span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in PhaseSynchro_Strobo computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in PhaseSynchro_Strobo computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in PhaseSynchro_Strobo computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>



<span class="sd">&quot;&quot;&quot; Display results &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;PhaseSynchro_Strobo complete result:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;lambda_nm:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Push ENTER key to exit.&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s">&quot;all&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="phasesynchro-entropy-example">
<h3><a class="toc-backref" href="#id17">PhaseSynchro_Entropy example</a><a class="headerlink" href="#phasesynchro-entropy-example" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference download internal" href="_downloads/PhaseSynchro_Entropy.py"><tt class="xref download docutils literal"><span class="pre">Source</span> <span class="pre">code</span></tt></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">PhaseSynchro_Entropy example :</span>
<span class="sd">It computes the n:m synchronization index rho_nm by using a Shannon entropy based approach between two univariate signals x and y</span>
<span class="sd">(in pandas DataFrame format). Rho_nm ranges in [0,1] where 0 means no synchronization at all and 1 means perfect synchronization.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Import common python packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>          <span class="c"># Mathematical package</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>         <span class="c"># Time serie package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span> <span class="c"># Plotting package</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;../src/&#39;</span><span class="p">)</span>   <span class="c"># To be able to import packages from parent directory </span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;********************************************************************************&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;This script computes the n:m synchronization index rho_nm by </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
       <span class="s">&quot;using a Shannon entropy based approach between two univariate signals x and y</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
       <span class="s">&quot;(in pandas DataFrame format). Rho_nm ranges in [0,1] where 0 means </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> 
       <span class="s">&quot;no synchronization at all and 1 means perfect synchronization.&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;********************************************************************************&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Import wanted module with every parent packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">DataFrom2Persons.Univariate.Continuous.Nonlinear.PhaseSynchro_Entropy</span> <span class="kn">as</span> <span class="nn">PhaseSynchro_Entropy</span>


<span class="sd">&quot;&quot;&quot; Define signals in pd.dataFrame format &quot;&quot;&quot;</span>

<span class="c">#Define parameters</span>
<span class="n">N</span><span class="o">=</span><span class="mi">1000</span>
<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>


<span class="n">x</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="n">y</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="mi">10</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>


<span class="sd">&quot;&quot;&quot;Plot input signals&quot;&quot;&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">f</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Input signals&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">)</span>


<span class="sd">&quot;&quot;&quot; Define class attributes of the wanted method &quot;&quot;&quot;</span>
<span class="n">n</span> <span class="o">=</span>  <span class="mi">3</span>                     <span class="c"># integer of the order of synchronization</span>
<span class="n">m</span>  <span class="o">=</span> <span class="mi">1</span>                     <span class="c"># integer of the order of synchronization</span>
<span class="n">nbins_mode</span> <span class="o">=</span> <span class="s">&#39;man&#39;</span>         <span class="c"># mode used to compute the nbins number</span>
<span class="n">nbins</span> <span class="o">=</span> <span class="mi">50</span>                 <span class="c"># number of bins</span>
<span class="n">dist_cyc_rel_phase</span> <span class="o">=</span> <span class="bp">False</span> <span class="c"># plot of the distribution of the cyclci relative phase</span>

<span class="sd">&quot;&quot;&quot; Instantiate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="o">=</span><span class="n">PhaseSynchro_Entropy</span><span class="o">.</span><span class="n">PhaseSynchro_Entropy</span><span class="p">(</span><span class="n">n</span> <span class="p">,</span><span class="n">m</span><span class="p">,</span> <span class="n">nbins_mode</span><span class="p">,</span> <span class="n">nbins</span><span class="p">,</span><span class="n">dist_cyc_rel_phase</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in PhaseSynchro_Entropy constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in PhaseSynchro_Entropy constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in PhaseSynchro_Entropy constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>


<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance of the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;n = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;m = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;nbins_mode = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nbins_mode</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;nbins = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nbins</span><span class="p">)</span><span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;dist_cyc_rel_phase =&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dist_cyc_rel_phase</span><span class="p">))</span>


<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">res</span><span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in PhaseSynchro_Entropy computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in PhaseSynchro_Entropy computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in PhaseSynchro_Entropy computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>



<span class="sd">&quot;&quot;&quot; Display results &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;PhaseSynchro_Entropy complete result:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;rho_nm:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Push ENTER key to exit.&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s">&quot;all&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="phasesynchro-fourier-example">
<h3><a class="toc-backref" href="#id18">PhaseSynchro_Fourier example</a><a class="headerlink" href="#phasesynchro-fourier-example" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference download internal" href="_downloads/PhaseSynchro_Fourier.py"><tt class="xref download docutils literal"><span class="pre">Source</span> <span class="pre">code</span></tt></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">PhaseSynchro_Fourier example :</span>
<span class="sd">It computes the n:m synchronization index gamma2_nm as the intensity of the first Fourier mode of the cyclic relative phase two continuous univariate signals x and y</span>
<span class="sd">(in DataFrame format). Gamma2_nm ranges in [0,1] where 0 means no synchronization at all and 1 means perfect synchronization.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Import common python packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>          <span class="c"># Mathematical package</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>         <span class="c"># Time serie package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span> <span class="c"># Plotting package</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;../src/&#39;</span><span class="p">)</span>   <span class="c"># To be able to import packages from parent directory </span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************************************************&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;This script computes the n:m synchronization index gamma2_nm as </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> 
      <span class="s">&quot;the intensity of the first Fourier mode of the cyclic relative phase </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> 
      <span class="s">&quot;of two continuous univariate signals x and y (in DataFrame format). </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> 
      <span class="s">&quot;Gamma2_nm ranges in [0,1] where 0 means no synchronization at all and 1 </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> 
      <span class="s">&quot;means perfect synchronization.&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************************************************&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Import wanted module with every parent packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">DataFrom2Persons.Univariate.Continuous.Nonlinear.PhaseSynchro_Fourier</span> <span class="kn">as</span> <span class="nn">PhaseSynchro_Fourier</span>


<span class="sd">&quot;&quot;&quot; Define signals in pd.dataFrame format &quot;&quot;&quot;</span>

<span class="c">#Define parameters</span>
<span class="n">N</span><span class="o">=</span><span class="mi">1000</span>
<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>


<span class="n">x</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="n">y</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="mi">10</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>


<span class="sd">&quot;&quot;&quot;Plot input signals&quot;&quot;&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">f</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Input signals&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">)</span>


<span class="sd">&quot;&quot;&quot; Define class attributes of the wanted method &quot;&quot;&quot;</span>
<span class="n">n</span> <span class="o">=</span>  <span class="mi">2</span>                     <span class="c"># integer of the order of synchronization</span>
<span class="n">m</span>  <span class="o">=</span> <span class="mi">1</span>                     <span class="c"># integer of the order of synchronization</span>

<span class="sd">&quot;&quot;&quot; Instantiate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="o">=</span><span class="n">PhaseSynchro_Fourier</span><span class="o">.</span><span class="n">PhaseSynchro_Fourier</span><span class="p">(</span><span class="n">n</span> <span class="p">,</span><span class="n">m</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in PhaseSynchro_Fourier constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in PhaseSynchro_Fourier constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in PhaseSynchro_Fourier constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>


<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance of the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;n = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;m = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>


<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">res</span><span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in PhaseSynchro_Fourier computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in PhaseSynchro_Fourier computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in PhaseSynchro_Fourier computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>



<span class="sd">&quot;&quot;&quot; Display results &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;PhaseSynchro_Fourier complete result:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;gamma2_nm:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Push ENTER key to exit.&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s">&quot;all&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="datafrommanypersons-univariate-continuous-linear-module">
<h2><a class="toc-backref" href="#id19">DataFromManyPersons Univariate Continuous Linear module</a><a class="headerlink" href="#datafrommanypersons-univariate-continuous-linear-module" title="Permalink to this headline">¶</a></h2>
<div class="section" id="conditional-granger-causality-example">
<h3><a class="toc-backref" href="#id20">Conditional Granger Causality example</a><a class="headerlink" href="#conditional-granger-causality-example" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference download internal" href="_downloads/ConditionalGrangerCausality.py"><tt class="xref download docutils literal"><span class="pre">Source</span> <span class="pre">code</span></tt></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">ConditionalGrangerCausality example :</span>
<span class="sd">It computes Condtional Granger Causality among signals (in pandas DataFrame format) organized as a list. </span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Import common python packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>              <span class="c"># Mathematical package</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>             <span class="c"># Time serie package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span> <span class="c"># Plotting package</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;../src/&#39;</span><span class="p">)</span>       <span class="c"># To be able to import from parent directory</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;=================================================================&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;== Testing for Conditional Granger Causality between 4 signals ==&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;=================================================================&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Import Utils modules &quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">utils.ExtractSignal</span> <span class="kn">import</span> <span class="n">ExtractSignalFromCSV</span>
<span class="kn">from</span> <span class="nn">utils.ResampleAndInterpolate</span> <span class="kn">import</span> <span class="n">ResampleAndInterpolate</span>

<span class="sd">&quot;&quot;&quot; Import wanted module with every parent packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">DataFromManyPersons.Univariate.Continuous.Linear.ConditionalGrangerCausality</span> <span class="kn">as</span> <span class="nn">CGC</span>

<span class="sd">&quot;&quot;&quot; Import signal from a .csv file &quot;&quot;&quot;</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s">&#39;data_examples/1Person_Multivariate_Continuous_data.csv&#39;</span>
<span class="k">print</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Loading signals from csv files : &quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">ExtractSignalFromCSV</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;x1&#39;</span><span class="p">])</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">ExtractSignalFromCSV</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;x2&#39;</span><span class="p">])</span>
<span class="n">x3</span> <span class="o">=</span> <span class="n">ExtractSignalFromCSV</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;x3&#39;</span><span class="p">])</span>
<span class="n">x4</span> <span class="o">=</span> <span class="n">ExtractSignalFromCSV</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;x4&#39;</span><span class="p">])</span>


<span class="sd">&quot;&quot;&quot; Define class attributes &quot;&quot;&quot;</span>
<span class="n">max_lag</span> <span class="o">=</span> <span class="mi">10</span> 		<span class="c"># Define the maximum lag acceptable to estimate autoregressive models</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="s">&#39;bic&#39;</span>	<span class="c"># Define the criterion to estimate the optimal number of lags to estimate autoregressive models</span>
<span class="n">plot</span> <span class="o">=</span> <span class="bp">True</span>			<span class="c"># Authorize the plot of the results</span>

<span class="sd">&quot;&quot;&quot; Instantiate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">try</span> <span class="p">:</span> 
	<span class="n">cgc</span> <span class="o">=</span> <span class="n">CGC</span><span class="o">.</span><span class="n">ConditionalGrangerCausality</span><span class="p">(</span><span class="n">max_lag</span> <span class="o">=</span> <span class="n">max_lag</span><span class="p">,</span> <span class="n">criterion</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">,</span> <span class="n">plot</span> <span class="o">=</span> <span class="n">plot</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in ConditionalGrangerCausality constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in ConditionalGrangerCausality constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in ConditionalGrangerCausality constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance of the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
		<span class="s">&quot;max_lag = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">max_lag</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
		<span class="s">&quot;criterion = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">criterion</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
		<span class="s">&quot;plot = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">plot</span><span class="p">))</span>
	
<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">try</span> <span class="p">:</span> 
	<span class="n">results</span> <span class="o">=</span> <span class="n">cgc</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="p">,</span><span class="n">x4</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in ConditionalGrangerCausality computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in ConditionalGrangerCausality computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in ConditionalGrangerCausality computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
	
<span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Press any key to exit&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="omega-complexity-example">
<h3><a class="toc-backref" href="#id21">Omega complexity example</a><a class="headerlink" href="#omega-complexity-example" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference download internal" href="_downloads/Omega_Complexity.py"><tt class="xref download docutils literal"><span class="pre">Source</span> <span class="pre">code</span></tt></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Omega_Complexity example :</span>
<span class="sd">Compute Omega_Complexity for multiple monovariate signals (organized as a list of pandas DataFrames).</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Import common python packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>              <span class="c"># Mathematical package</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>             <span class="c"># Time serie package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span> <span class="c"># Plotting package</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;../src/&#39;</span><span class="p">)</span>       <span class="c"># To be able to import from parent directory</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;**********************************************************************&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;This script computes Omega_Complexity for multiple monovariate signals </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> 
      <span class="s">&quot;(organized as a list of pandas DataFrames) </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;**********************************************************************&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Import wanted module with every parent packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">DataFromManyPersons.Univariate.Continuous.Linear.Omega_Complexity</span> <span class="kn">as</span> <span class="nn">Omega_Complexity</span>
<span class="kn">from</span> <span class="nn">utils.ExtractSignal</span> <span class="kn">import</span> <span class="n">ExtractSignalFromCSV</span>
<span class="kn">from</span> <span class="nn">utils.ExtractSignal</span> <span class="kn">import</span> <span class="n">ExtractSignalFromMAT</span>
<span class="kn">from</span> <span class="nn">utils.Standardize</span> <span class="kn">import</span> <span class="n">Standardize</span>

<span class="sd">&quot;&quot;&quot; Define signals in pd.dataFrame format &quot;&quot;&quot;</span>
<span class="c"># preparing the input time series</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>             <span class="c"># number of samples</span>
<span class="n">f</span> <span class="o">=</span> <span class="mf">1.0</span>             <span class="c"># sinewave frequency (Hz)</span>
<span class="n">Fs</span> <span class="o">=</span> <span class="mi">200</span>            <span class="c"># sampling frequency (Hz)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>  <span class="c"># number of samples</span>
<span class="c"># input time series</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mf">3.14</span><span class="o">*</span><span class="n">f</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="n">Fs</span><span class="p">)},</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;Y&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="mf">3.14</span><span class="o">*</span><span class="n">f</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="n">Fs</span><span class="p">)},</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;Z&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mf">3.14</span><span class="o">*</span><span class="n">f</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="n">Fs</span><span class="p">)},</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>


<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">&quot;&quot;&quot;OR&quot;&quot;&quot;</span>
<span class="sd">&quot;&quot;&quot; Import signal from a .csv file &quot;&quot;&quot;</span>
<span class="sd">filename = &#39;data_examples/2Persons_Multivariate_Continous_data.csv&#39;</span>
<span class="sd">x = ExtractSignalFromCSV(filename, columns = [&#39;Upper body mq&#39;])</span>
<span class="sd">y = ExtractSignalFromCSV(filename, columns = [&#39;Upper body mq.1&#39;])</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">&#39;&#39;&#39;&#39;</span>
<span class="sd">&quot;&quot;&quot;OR&quot;&quot;&quot;</span>
<span class="sd">&quot;&quot;&quot; Import signal from a .mat file &quot;&quot;&quot;</span>
<span class="sd">filename = &#39;data_examples/data_example_MAT.mat&#39;</span>
<span class="sd">z = ExtractSignalFromMAT(filename, columns_index =[0,2], columns_wanted_names=[&#39;Time&#39;, &#39;GlobalBodyActivity0&#39;])</span>
<span class="sd">t = ExtractSignalFromMAT(filename, columns_index =[10], columns_wanted_names=[&#39;GlobalBodyActivity1&#39;])</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="n">signals</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="p">]</span>

<span class="n">N</span> <span class="o">=</span> <span class="n">signals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> 

<span class="sd">&quot;&quot;&quot; Plot input signals &quot;&quot;&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;input signals&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">signals</span><span class="p">))</span> <span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">signals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">signals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_transform</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">transFigure</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Define class attributes of the wanted method &quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Instantiate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">try</span> <span class="p">:</span> 
    <span class="n">omega_comp</span> <span class="o">=</span> <span class="n">Omega_Complexity</span><span class="o">.</span><span class="n">Omega_Complexity</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in Omega_Complexity constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in Omega_Complexity constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in Omega_Complexity constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Instantiating the class...&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">omega</span> <span class="o">=</span> <span class="n">omega_comp</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="o">*</span><span class="n">signals</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in Omega_Complexity computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in Omega_Complexity computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in Omega_Complexity computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Display result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Omega_Complexity result :&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">omega</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="s">&quot; : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Push ENTER key to exit.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="partialcoherence-example">
<h3><a class="toc-backref" href="#id22">PartialCoherence example</a><a class="headerlink" href="#partialcoherence-example" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference download internal" href="_downloads/PartialCoherence.py"><tt class="xref download docutils literal"><span class="pre">Source</span> <span class="pre">code</span></tt></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">PartialCoherence example :</span>
<span class="sd">Compute Partial Coherence for multiple monovariate signals (orgainized as a list).</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Import common python packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>              <span class="c"># Mathematical package</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>             <span class="c"># Time serie package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span> <span class="c"># Plotting package</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;../src&#39;</span><span class="p">)</span>       <span class="c"># To be able to import from parent directory</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;***********************************************************************&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;This script computes Partial Coherence for multiple monovariate signals </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> 
      <span class="s">&quot;(organized as a list) </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;***********************************************************************&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Import wanted module with every parent packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">DataFromManyPersons.Univariate.Continuous.Linear.PartialCoherence</span> <span class="kn">as</span> <span class="nn">PartialCoherence</span>
<span class="kn">from</span> <span class="nn">utils.ExtractSignal</span> <span class="kn">import</span> <span class="n">ExtractSignalFromCSV</span>
<span class="kn">from</span> <span class="nn">utils.ExtractSignal</span> <span class="kn">import</span> <span class="n">ExtractSignalFromMAT</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">&quot;&quot;&quot; Define signals in pd.dataFrame format &quot;&quot;&quot;</span>
<span class="sd"># preparing the input time series</span>
<span class="sd">N = 20             # number of samples</span>
<span class="sd">f = 1.0             # sinewave frequency (Hz)</span>
<span class="sd">Fs = 200            # sampling frequency (Hz)</span>
<span class="sd">n = np.arange(0,N)  # number of samples</span>
<span class="sd"># input time series</span>
<span class="sd">x = pd.DataFrame({&#39;X&#39;:np.sin(2*3.14*f*n/Fs)})</span>
<span class="sd">y = pd.DataFrame({&#39;Y&#39;:np.sin(2*3.14*2*f*n/Fs)})</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="sd">&quot;&quot;&quot;OR&quot;&quot;&quot;</span>
<span class="sd">&quot;&quot;&quot; Import signal from a .csv file &quot;&quot;&quot;</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s">&#39;data_examples/2Persons_Multivariate_Continous_data.csv&#39;</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ExtractSignalFromCSV</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Upper body mq&#39;</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ExtractSignalFromCSV</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Upper body mq.1&#39;</span><span class="p">])</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">ExtractSignalFromCSV</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Left Hand mq&#39;</span><span class="p">])</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">ExtractSignalFromCSV</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Left Hand mq.1&#39;</span><span class="p">])</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">&quot;&quot;&quot;OR&quot;&quot;&quot;</span>
<span class="sd">&quot;&quot;&quot; Import signal from a .mat file &quot;&quot;&quot;</span>
<span class="sd">filename = &#39;data_examples/data_example_MAT.mat&#39;</span>
<span class="sd">x = ExtractSignalFromMAT(filename, columns_index =[0,2], columns_wanted_names=[&#39;Time&#39;, &#39;GlobalBodyActivity0&#39;])</span>
<span class="sd">y = ExtractSignalFromMAT(filename, columns_index =[10], columns_wanted_names=[&#39;GlobalBodyActivity1&#39;])</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="n">signals</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">a</span><span class="p">]</span>

<span class="n">N</span> <span class="o">=</span> <span class="n">signals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> 

<span class="sd">&quot;&quot;&quot; Plot input signals &quot;&quot;&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Input signals&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">signals</span><span class="p">))</span> <span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">signals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">signals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_transform</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">transFigure</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Define class attributes of the wanted method &quot;&quot;&quot;</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mf">1.0</span>        <span class="c"># sampling frequency of the input DataFrame in Hz</span>
<span class="n">NFFT</span> <span class="o">=</span> <span class="mi">256</span>      <span class="c"># length of each epoch</span>
<span class="n">detrend</span> <span class="o">=</span> <span class="mi">1</span>     <span class="c"># specifies which kind of detrending should be computed on data. 0 stands for constant detrending; 1 stands for linear detrending</span>
<span class="n">noverlap</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c"># number of points to overlap between epochs</span>

<span class="sd">&quot;&quot;&quot; Instanciate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">try</span> <span class="p">:</span> 
    <span class="n">pc</span> <span class="o">=</span> <span class="n">PartialCoherence</span><span class="o">.</span><span class="n">PartialCoherence</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">NFFT</span><span class="p">,</span> <span class="n">detrend</span><span class="p">,</span> <span class="n">noverlap</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in PartialCoherence constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in PartialCoherence constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in PartialCoherence constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;fs = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;NFFT = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">NFFT</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;detrend = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">detrend</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;noverlap = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">noverlap</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
      <span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">partial_coherence</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="o">*</span><span class="n">signals</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in PartialCoherence computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in PartialCoherence computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in PartialCoherence computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Display result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;PartialCoherence computed for theses signals indexes :&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">partial_coherence</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">partial_coherence</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span> <span class="o">+</span> <span class="s">&quot; given &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span> <span class="s">&quot;, &quot;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Push ENTER key to exit.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-estimator-example">
<h3><a class="toc-backref" href="#id23">S_Estimator example</a><a class="headerlink" href="#s-estimator-example" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference download internal" href="_downloads/S_Estimator.py"><tt class="xref download docutils literal"><span class="pre">Source</span> <span class="pre">code</span></tt></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">S_Estimator example :</span>
<span class="sd">Compute Synchronization Indexes for multiple monovariate signals (orgainized as a list).</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Import common python packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>              <span class="c"># Mathematical package</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>             <span class="c"># Time serie package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span> <span class="c"># Plotting package</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;../src/&#39;</span><span class="p">)</span>       <span class="c"># To be able to import from parent directory</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;*************************************************************************************&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;This script computes Synchronization indexes for multiple monovariate signals </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> 
      <span class="s">&quot;(orgainized as a list) </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;*************************************************************************************&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Import wanted module with every parent packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">DataFromManyPersons.Univariate.Continuous.Linear.S_Estimator</span> <span class="kn">as</span> <span class="nn">S_Estimator</span>
<span class="kn">from</span> <span class="nn">utils.ExtractSignal</span> <span class="kn">import</span> <span class="n">ExtractSignalFromCSV</span>
<span class="kn">from</span> <span class="nn">utils.ExtractSignal</span> <span class="kn">import</span> <span class="n">ExtractSignalFromMAT</span>
<span class="kn">from</span> <span class="nn">utils.Standardize</span> <span class="kn">import</span> <span class="n">Standardize</span>


<span class="sd">&quot;&quot;&quot; Define signals in pd.dataFrame format &quot;&quot;&quot;</span>
<span class="c"># preparing the input signals</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>             <span class="c"># number of samples</span>
<span class="n">f</span> <span class="o">=</span> <span class="mf">1.0</span>             <span class="c"># sinewave frequency (Hz)</span>
<span class="n">Fs</span> <span class="o">=</span> <span class="mi">200</span>            <span class="c"># sampling frequency (Hz)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>  <span class="c"># number of samples</span>
<span class="c"># input signals</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mf">3.14</span><span class="o">*</span><span class="n">f</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="n">Fs</span><span class="p">)},</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;Y&#39;</span><span class="p">:</span><span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mf">3.14</span><span class="o">*</span><span class="n">f</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="n">Fs</span><span class="p">)},</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">&quot;&quot;&quot;OR&quot;&quot;&quot;</span>
<span class="sd">&quot;&quot;&quot; Import signals from a .csv file &quot;&quot;&quot;</span>
<span class="sd">filename = &#39;data_examples/2Persons_Multivariate_Continous_data.csv&#39;</span>
<span class="sd">x = ExtractSignalFromCSV(filename, columns = [&#39;Upper body mq&#39;])</span>
<span class="sd">y = ExtractSignalFromCSV(filename, columns = [&#39;Upper body mq.1&#39;])</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">&quot;&quot;&quot;OR&quot;&quot;&quot;</span>
<span class="sd">&quot;&quot;&quot; Import signals from a .mat file &quot;&quot;&quot;</span>
<span class="sd">filename = &#39;data_examples/data_example_MAT.mat&#39;</span>
<span class="sd">x = ExtractSignalFromMAT(filename, columns_index =[0,2], columns_wanted_names=[&#39;Time&#39;, &#39;GlobalBodyActivity0&#39;])</span>
<span class="sd">y = ExtractSignalFromMAT(filename, columns_index =[10], columns_wanted_names=[&#39;GlobalBodyActivity1&#39;])</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="n">signals</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span>

<span class="n">N</span> <span class="o">=</span> <span class="n">signals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> 

<span class="sd">&quot;&quot;&quot; Plot standardized input signals &quot;&quot;&quot;</span>
<span class="n">Signals</span> <span class="o">=</span> <span class="n">signals</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>

<span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Signals</span><span class="p">)</span>
<span class="n">figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span>  <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Signals</span><span class="p">))</span> <span class="p">:</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span> <span class="c"># Display a grid</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Standardized signal for : &#39;</span> <span class="o">+</span> <span class="n">Signals</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39; variable&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">Signals</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
    
<span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Define class attributes of the wanted method &quot;&quot;&quot;</span>
<span class="n">surr_nb_iter</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">plot_surrogate</span> <span class="o">=</span> <span class="bp">True</span> 

<span class="sd">&quot;&quot;&quot; Instanciate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">try</span> <span class="p">:</span> 
    <span class="n">s_estimator</span> <span class="o">=</span> <span class="n">S_Estimator</span><span class="o">.</span><span class="n">S_Estimator</span><span class="p">(</span><span class="n">surr_nb_iter</span><span class="p">,</span> <span class="n">plot_surrogate</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in S_Estimator constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in S_Estimator constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in S_Estimator constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;surr_nb_iter = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">surr_nb_iter</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
      <span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">estimators</span> <span class="o">=</span> <span class="n">s_estimator</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="o">*</span><span class="n">signals</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in S_Estimator computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in S_Estimator computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in S_Estimator computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Display result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;S_Estimator result :&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">estimators</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="s">&quot; : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">estimators</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Push ENTER key to exit.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="multiple-granger-causality-example">
<h3><a class="toc-backref" href="#id24">Multiple Granger Causality example</a><a class="headerlink" href="#multiple-granger-causality-example" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference download internal" href="_downloads/MultipleGrangerCausality.py"><tt class="xref download docutils literal"><span class="pre">Source</span> <span class="pre">code</span></tt></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">MultipleGrangerCausality example :</span>
<span class="sd">Computes a Granger Causality test between some signals that are stored as a pandas DataFrame</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Import common python packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>              <span class="c"># Mathematical package</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>             <span class="c"># Time serie package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span> <span class="c"># Plotting package</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;../src/&#39;</span><span class="p">)</span>       <span class="c"># To be able to import from parent directory</span>


<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;*************************************************************************************&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;This script computes the Granger Causality test between some signals </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;in pandas DataFrame format.&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;*************************************************************************************&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Import wanted module with every parent packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">DataFromManyPersons.Univariate.Continuous.Linear.MultipleGrangerCausality</span> <span class="kn">as</span> <span class="nn">MGC</span>
<span class="kn">from</span> <span class="nn">utils.ExtractSignal</span> <span class="kn">import</span> <span class="n">ExtractSignalFromCSV</span>


<span class="sd">&quot;&quot;&quot; Define signals in pd.dataFrame format &quot;&quot;&quot;</span>
<span class="c"># preparing the input time series</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span> 								<span class="c"># Size of signals</span>
<span class="n">X</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;X&#39;</span> <span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)})</span>	<span class="c"># Signal to test</span>
<span class="n">Y1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;Y1&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)})</span>	<span class="c"># Helping signal n1</span>
<span class="n">Y2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;Y2&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)})</span>	<span class="c"># Helping signal n2</span>
<span class="n">Y3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;Y3&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)})</span>	<span class="c"># Helping signal n3</span>
<span class="n">signal</span> <span class="o">=</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span><span class="n">Y1</span><span class="p">,</span><span class="n">Y2</span><span class="p">,</span><span class="n">Y3</span><span class="p">]</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">&quot;&quot;&quot;OR&quot;&quot;&quot;</span>
<span class="sd">&quot;&quot;&quot; Import signal from a .csv file &quot;&quot;&quot;</span>
<span class="sd">filename = &#39;data_examples/1Person_Multivariate_Continous_data.csv&#39;</span>
<span class="sd">x1 = ExtractSignalFromCSV(filename, columns = [&#39;x1&#39;])</span>
<span class="sd">x2 = ExtractSignalFromCSV(filename, columns = [&#39;x2&#39;])</span>
<span class="sd">x3 = ExtractSignalFromCSV(filename, columns = [&#39;x3&#39;])</span>
<span class="sd">x4 = ExtractSignalFromCSV(filename, columns = [&#39;x4&#39;])</span>
<span class="sd">x5 = ExtractSignalFromCSV(filename, columns = [&#39;x5&#39;])</span>
<span class="sd">signal = [x1,x2,x3,x4,x5]</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="sd">&quot;&quot;&quot; Plot input signals &quot;&quot;&quot;</span>
<span class="n">Signals</span> <span class="o">=</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Y1</span><span class="p">,</span> <span class="n">Y2</span><span class="p">,</span> <span class="n">Y3</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>

<span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Signals</span><span class="p">)</span>
<span class="n">figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span>  <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Signals</span><span class="p">))</span> <span class="p">:</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span> <span class="c"># Display a grid</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Input signal : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Signals</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Signals</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">Signals</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
    
<span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Time&#39;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Define class attributes &quot;&quot;&quot;</span>
<span class="n">max_lag</span> <span class="o">=</span> <span class="mi">10</span> 		<span class="c"># Define the maximum lag acceptable to estimate autoregressive models</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="s">&#39;aic&#39;</span>	<span class="c"># Define the criterion to estimate the optimal number of lags to estimate autoregressive models</span>
<span class="n">plot</span> <span class="o">=</span> <span class="bp">True</span>		<span class="c"># Authorize the plot of the results</span>

<span class="sd">&quot;&quot;&quot; Instanciate the class with its attributes &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">try</span> <span class="p">:</span> 
	<span class="n">mgc</span> <span class="o">=</span> <span class="n">MGC</span><span class="o">.</span><span class="n">MultipleGrangerCausality</span><span class="p">(</span><span class="n">max_lag</span> <span class="o">=</span> <span class="n">max_lag</span><span class="p">,</span> <span class="n">criterion</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">,</span> <span class="n">plot</span> <span class="o">=</span> <span class="n">plot</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in MultipleGrangerCausality constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in MultipleGrangerCausality constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in MultipleGrangerCausality constructor : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance of the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
		<span class="s">&quot;max_lag = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">max_lag</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
		<span class="s">&quot;criterion = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">criterion</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
		<span class="s">&quot;plot = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">plot</span><span class="p">))</span>
	
<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
	<span class="n">results</span> <span class="o">=</span> <span class="n">mgc</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="o">*</span><span class="n">signal</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in MultipleGrangerCausality computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in MultipleGrangerCausality computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in MultipleGrangerCausality computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>


<span class="c"># Displaying results :</span>
<span class="k">print</span> <span class="s">&quot;Computing autoregressive model &#39;restricted&#39; and &#39;unrestricted&#39; via the &#39;Ordinary Least Squares&#39; method</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="k">print</span> <span class="s">&quot;According to&quot;</span><span class="p">,</span><span class="n">criterion</span><span class="p">,</span><span class="s">&quot;, the optimal number of lag estimated is :&quot;</span><span class="p">,</span> <span class="n">results</span><span class="p">[</span><span class="s">&#39;optimal_lag&#39;</span><span class="p">],</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="k">print</span> <span class="s">&quot;F_value =&quot;</span><span class="p">,</span><span class="n">results</span><span class="p">[</span><span class="s">&#39;F_value&#39;</span><span class="p">],</span><span class="s">&quot; with p_value =&quot;</span><span class="p">,</span><span class="n">results</span><span class="p">[</span><span class="s">&#39;p_value&#39;</span><span class="p">],</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>

<span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Push ENTER key to exit.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="datafrom2persons-multivariate-continuous-nonlinear-module">
<h2><a class="toc-backref" href="#id25">DataFrom2Persons Multivariate Continuous NonLinear module</a><a class="headerlink" href="#datafrom2persons-multivariate-continuous-nonlinear-module" title="Permalink to this headline">¶</a></h2>
<div class="section" id="gsi-example">
<h3><a class="toc-backref" href="#id26">GSI example</a><a class="headerlink" href="#gsi-example" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference download internal" href="_downloads/GSI.py"><tt class="xref download docutils literal"><span class="pre">Source</span> <span class="pre">code</span></tt></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">GSI example :</span>
<span class="sd">It computes the generalised synchronization index (GSI) between two uni/multi-variate signals x and y(in DataFrame format).</span>
<span class="sd">GSI ranges in [0,1] where 0 means no synchronization and 1 perfect generalized synchronization.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot; Import common python packages &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>              <span class="c"># Mathematical package</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>             <span class="c"># Time serie package</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span> <span class="c"># Plotting package</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;../src/&#39;</span><span class="p">)</span>   <span class="c"># To be able to import packages from parent directory </span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;*****************************************************************************&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;This script computes the generalised synchronization index (GSI) between </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;two uni/multi-variate signals x and y(in DataFrame format).</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;GSI ranges in [0,1] where 0 means no synchronization and 1 perfect generalized synchronization.&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;*****************************************************************************&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Import wanted module  &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">DataFrom2Persons.Multivariate.Continuous.Nonlinear.GSI</span> <span class="kn">as</span> <span class="nn">GSI</span>

<span class="sd">&quot;&quot;&quot; Define signals in pd.dataFrame format &quot;&quot;&quot;</span>

<span class="c">#Define parameters</span>
<span class="n">N</span><span class="o">=</span><span class="mi">1000</span>
<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>

<span class="c">#Create signals</span>
<span class="n">x</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="n">y</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="mi">10</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>

<span class="sd">&quot;&quot;&quot;Plot input signals&quot;&quot;&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">f</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Input signals&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; Define parameters of the wanted method &quot;&quot;&quot;</span>
<span class="n">m</span><span class="o">=</span><span class="mi">1</span>                       <span class="c"># the mebedding dimension</span>
<span class="n">t</span><span class="o">=</span><span class="mi">1</span>                       <span class="c"># the delay between data</span>
<span class="n">rr</span><span class="o">=</span><span class="mf">0.1</span>                    <span class="c"># the threshold rate for recurrence</span>


<span class="sd">&quot;&quot;&quot; Call CrossRecurrencePlot utils method &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="k">try</span> <span class="p">:</span> 
    <span class="n">c</span> <span class="o">=</span><span class="n">GSI</span><span class="o">.</span><span class="n">GSI</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">rr</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in GSI : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in GSI : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in GSI : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>



<span class="k">print</span><span class="p">(</span><span class="s">&quot;An instance of the class is now created with the following parameters:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;m = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;t = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
      <span class="s">&quot;rr = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rr</span><span class="p">))</span>


<span class="sd">&quot;&quot;&quot; Compute the method and get the result &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Computing...&quot;</span><span class="p">)</span>


<span class="k">try</span> <span class="p">:</span> 
    <span class="n">res</span><span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;TypeError in GSI computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;ValueError in GSI computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Exception in GSI computation : </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>


<span class="sd">&quot;&quot;&quot; Display results &quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;GSI complete result:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;****************************************</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;GSI:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>




<span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Push ENTER key to exit.&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s">&quot;all&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="HomePage.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">SyncPy library Examples</a><ul>
<li><a class="reference internal" href="#datafrom2persons-univariate-categorical-linear-module">DataFrom2Persons Univariate Categorical Linear module</a><ul>
<li><a class="reference internal" href="#boolean-turn-activity-example">Boolean Turn Activity example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#datafrom2persons-univariate-categorical-nonlinear-module">DataFrom2Persons Univariate Categorical Nonlinear module</a><ul>
<li><a class="reference internal" href="#event-synchronization-example">Event Synchronization example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#datafrom2persons-univariate-continuous-linear-module">DataFrom2Persons Univariate Continuous Linear module</a><ul>
<li><a class="reference internal" href="#coherence-example">Coherence example</a></li>
<li><a class="reference internal" href="#correlation-example">Correlation example</a></li>
<li><a class="reference internal" href="#granger-causality-example">Granger Causality example</a></li>
<li><a class="reference internal" href="#spectral-granger-causality-example">Spectral Granger Causality example</a></li>
<li><a class="reference internal" href="#window-cross-correlation-example">Window Cross Correlation example</a></li>
<li><a class="reference internal" href="#window-cross-correlation-with-peakpicking-example">Window Cross Correlation with PeakPicking example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#datafrom2persons-univariate-continuous-nonlinear-module">DataFrom2Persons Univariate Continuous NonLinear module</a><ul>
<li><a class="reference internal" href="#nonlinear-correlation-example">Nonlinear Correlation example</a></li>
<li><a class="reference internal" href="#mutual-information-example">Mutual Information example</a></li>
<li><a class="reference internal" href="#window-mutual-information-example">Window Mutual Information example</a></li>
<li><a class="reference internal" href="#phasesynchro-strobo-example">PhaseSynchro_Strobo example</a></li>
<li><a class="reference internal" href="#phasesynchro-entropy-example">PhaseSynchro_Entropy example</a></li>
<li><a class="reference internal" href="#phasesynchro-fourier-example">PhaseSynchro_Fourier example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#datafrommanypersons-univariate-continuous-linear-module">DataFromManyPersons Univariate Continuous Linear module</a><ul>
<li><a class="reference internal" href="#conditional-granger-causality-example">Conditional Granger Causality example</a></li>
<li><a class="reference internal" href="#omega-complexity-example">Omega complexity example</a></li>
<li><a class="reference internal" href="#partialcoherence-example">PartialCoherence example</a></li>
<li><a class="reference internal" href="#s-estimator-example">S_Estimator example</a></li>
<li><a class="reference internal" href="#multiple-granger-causality-example">Multiple Granger Causality example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#datafrom2persons-multivariate-continuous-nonlinear-module">DataFrom2Persons Multivariate Continuous NonLinear module</a><ul>
<li><a class="reference internal" href="#gsi-example">GSI example</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="utils.html"
                        title="previous chapter">Utils package</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="References.html"
                        title="next chapter">Publications</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="References.html" title="Publications"
             >next</a> |</li>
        <li class="right" >
          <a href="utils.html" title="Utils package"
             >previous</a> |</li>
        <li><a href="HomePage.html">Home Page</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Giovanna Varni, Marie Avril.
      Last updated on Jan 28, 2016.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>